"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[650],{90650:(z,L,n)=>{n.r(L),n.d(L,{default:()=>ke});var C=n(74710),k=n(10467),e=n(54438),f=n(60177),N=n(89417),S=n(82765),E=n(75351),v=n(59042),y=n(59115),T=n(96695),I=n(2042),d=n(9159),m=n(99213),_=n(48807),V=n(46601),D=n(3366),Q=n(45794),M=n(35883),Z=n(10801);const q=()=>[5,10,20];function X(r,h){1&r&&(e.j41(0,"div",18),e.nrm(1,"div",19)(2,"div",19)(3,"div",19)(4,"div",19)(5,"div",19)(6,"div",19)(7,"div",20),e.k0s())}function W(r,h){1&r&&(e.j41(0,"mat-header-cell"),e.EFF(1," Tracking ID "),e.k0s())}function P(r,h){if(1&r&&(e.j41(0,"mat-cell",36)(1,"a"),e.EFF(2),e.k0s()()),2&r){const l=h.$implicit;e.R7$(2),e.JRh(l.tracking_id)}}function H(r,h){1&r&&(e.j41(0,"mat-header-cell"),e.EFF(1," Category "),e.k0s())}function A(r,h){if(1&r&&(e.j41(0,"mat-cell",37),e.EFF(1),e.k0s()),2&r){const l=h.$implicit;e.R7$(),e.SpI(" ",l.category," ")}}function B(r,h){1&r&&(e.j41(0,"mat-header-cell"),e.EFF(1," Products "),e.k0s())}function J(r,h){if(1&r&&(e.j41(0,"mat-cell",37),e.EFF(1),e.k0s()),2&r){const l=h.$implicit;e.R7$(),e.SpI(" ",l.product," ")}}function ee(r,h){1&r&&(e.j41(0,"mat-header-cell"),e.EFF(1," Deleted By "),e.k0s())}function te(r,h){if(1&r&&(e.j41(0,"mat-cell",37),e.EFF(1),e.k0s()),2&r){const l=h.$implicit;e.R7$(),e.SpI(" ",l.deleted_by," ")}}function ae(r,h){1&r&&(e.j41(0,"mat-header-cell"),e.EFF(1," Deleted at "),e.k0s())}function ie(r,h){if(1&r&&(e.j41(0,"mat-cell",38),e.EFF(1),e.k0s()),2&r){const l=h.$implicit;e.R7$(),e.SpI(" ",l.deleted_at," ")}}function G(r,h){1&r&&(e.j41(0,"mat-header-cell",39),e.EFF(1," Action "),e.k0s())}function ne(r,h){if(1&r){const l=e.RV6();e.j41(0,"div",41)(1,"a",42),e.bIt("click",function(){e.eBV(l);const g=e.XpG().$implicit,b=e.XpG(3);return e.Njj(b.handleRestoreTickets(g.tracking_id))}),e.nrm(2,"mat-icon",43),e.k0s(),e.j41(3,"a",44),e.bIt("click",function(){e.eBV(l);const g=e.XpG().$implicit,b=e.XpG(3);return e.Njj(b.handleDeleteTempTicket(g.tracking_id))}),e.nrm(4,"mat-icon",45),e.k0s()()}}function oe(r,h){if(1&r&&(e.j41(0,"mat-cell"),e.DNE(1,ne,5,0,"div",40),e.k0s()),2&r){const l=h.$implicit;e.R7$(),e.Y8G("ngIf","default-trial"!=l.name)}}function K(r,h){1&r&&e.nrm(0,"mat-header-row")}function se(r,h){1&r&&e.nrm(0,"mat-row")}function re(r,h){if(1&r&&(e.j41(0,"mat-table",21,1)(2,"div"),e.qex(3,22),e.DNE(4,W,2,0,"mat-header-cell",23)(5,P,3,1,"mat-cell",24),e.bVm(),e.qex(6,25),e.DNE(7,H,2,0,"mat-header-cell",23)(8,A,2,1,"mat-cell",26),e.bVm(),e.qex(9,27),e.DNE(10,B,2,0,"mat-header-cell",23)(11,J,2,1,"mat-cell",26),e.bVm(),e.qex(12,28),e.DNE(13,ee,2,0,"mat-header-cell",23)(14,te,2,1,"mat-cell",26),e.bVm(),e.qex(15,29),e.DNE(16,ae,2,0,"mat-header-cell",23)(17,ie,2,1,"mat-cell",30),e.bVm(),e.qex(18,31),e.DNE(19,G,2,0,"mat-header-cell",32)(20,oe,2,1,"mat-cell",33),e.bVm(),e.DNE(21,K,1,0,"mat-header-row",34)(22,se,1,0,"mat-row",35),e.k0s()()),2&r){const l=e.XpG(2);e.Y8G("dataSource",l.dataSource),e.R7$(21),e.Y8G("matHeaderRowDef",l.displayedColumns),e.R7$(),e.Y8G("matRowDefColumns",l.displayedColumns)}}function le(r,h){1&r&&(e.j41(0,"div",46)(1,"div",47),e.nrm(2,"img",48)(3,"br"),e.j41(4,"p",49),e.EFF(5,"Data Not Found"),e.k0s(),e.j41(6,"p",50),e.EFF(7,"try using a different keyword or add a new tickets"),e.k0s()()())}function ce(r,h){if(1&r){const l=e.RV6();e.j41(0,"section",3)(1,"div",4)(2,"h1",5),e.EFF(3,"Deleted Tickets"),e.k0s(),e.j41(4,"div",6)(5,"label",7),e.EFF(6,"Search"),e.k0s(),e.j41(7,"div",8)(8,"div",9),e.qSk(),e.j41(9,"svg",10),e.nrm(10,"path",11),e.k0s()(),e.joV(),e.j41(11,"input",12),e.bIt("keyup",function(g){e.eBV(l);const b=e.XpG();return e.Njj(b.applyFilter(g.target.value))}),e.k0s()()()(),e.DNE(12,X,8,0,"div",13),e.j41(13,"div",14),e.DNE(14,re,23,3,"mat-table",15),e.k0s(),e.DNE(15,le,8,0,"div",16),e.nrm(16,"mat-paginator",17,0),e.k0s()}if(2&r){const l=e.XpG();e.R7$(12),e.Y8G("ngIf",l.isLoading),e.R7$(2),e.Y8G("ngIf",!l.isLoading),e.R7$(),e.Y8G("ngIf",l.isNotDataFound&&!l.isLoading),e.R7$(),e.Y8G("pageSize",10)("pageSizeOptions",e.lJ4(6,q))("showFirstLastButtons",!0)}}let me=(()=>{class r{constructor(l,u,g,b,O,ve){this._tempTicketsService=l,this.fuseConfirmationService=u,this._apiService=g,this._toastService=b,this._ticketTableService=O,this._ticketLogsService=ve,this.displayedColumns=["tracking_id","category","product","deleted_by","deleted_at","action"],this.dataSource=new d.I6,this.isAdmin="admin"===localStorage.getItem("userRole"),this._tempTicketsService.fetchData(),(0,e.QZP)(()=>{this.dataSource.data=this.dataTempTickets})}get isNotDataFound(){return this._tempTicketsService.isNotFound()}get isLoading(){return this._tempTicketsService.isLoading()}get dataTempTickets(){return this._tempTicketsService._data()}ngOnInit(){}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}applyFilter(l){l=(l=l.trim()).toLowerCase(),this.dataSource.filter=l}handleRestoreTickets(l){this.fuseConfirmationService.open({title:"Restore Confirmation",message:`Are you sure want to restore this ticket ${l}?`,icon:{show:!0,name:"restore",color:"primary"},actions:{confirm:{label:"Restore",color:"primary"}}}).afterClosed().subscribe(g=>{"confirmed"===g&&this.restoreTickets(l)})}restoreTickets(l){var u=this;return(0,k.A)(function*(){try{const{status:b}=yield u._apiService.post(`api/V1/tickets/restore/${l}`,{});return 200===b?(u._toastService.success("Success Restore Ticket","Success"),u._tempTicketsService.fetchData(),u._ticketTableService.fetchData(),void u._ticketLogsService.fetchDatas()):void u._toastService.error("Failed Restore Ticket","Failed")}catch(g){throw u._toastService.error("Failed Restore Ticket","Failed"),g}})()}handleDeleteTempTicket(l){this.fuseConfirmationService.open({title:"Delete Confirmation",message:`Are you sure want to delete this ticket permanent ${l}?`,actions:{confirm:{label:"Delete"}}}).afterClosed().subscribe(g=>{"confirmed"===g&&this.deleteTempTicket(l)})}deleteTempTicket(l){var u=this;return(0,k.A)(function*(){try{const{status:b}=yield u._apiService.delete(`api/V1/tickets/temp/${l}`);return 200===b?(u._toastService.success("Success Delete Tickets Permanent","Success"),void u._tempTicketsService.fetchData()):void u._toastService.error("Failed Delete Tickets Permanent","Failed")}catch(g){throw u._toastService.error("Failed Delete Tickets Permanent","Failed"),g}})()}static{this.\u0275fac=function(u){return new(u||r)(e.rXU(_.X),e.rXU(V.G),e.rXU(D.G),e.rXU(Q.tw),e.rXU(M.M),e.rXU(Z.j))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-temp-tickets"]],viewQuery:function(u,g){if(1&u&&(e.GBs(I.B4,5),e.GBs(T.iy,5)),2&u){let b;e.mGM(b=e.lsd())&&(g.sort=b.first),e.mGM(b=e.lsd())&&(g.paginator=b.first)}},standalone:!0,features:[e.aNF],decls:1,vars:1,consts:[["paginator",""],["table",""],["class","h-fit border-[1px] shadow-xl mt-4 bg-white rounded-lg p-5",4,"ngIf"],[1,"h-fit","border-[1px]","shadow-xl","mt-4","bg-white","rounded-lg","p-5"],[1,"flex","flex-col","items-start","sm:flex-row","sm:items-center","justify-between"],[1,"text-2xl","font-semibold"],[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","gap-3","w-1/3","max-lg:w-full"],["for","table-search",1,"sr-only"],[1,"relative","my-2","w-full"],[1,"absolute","inset-y-0","rtl:inset-r-0","start-0","flex","items-center","ps-3","pointer-events-none"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 20 20",1,"w-4","h-4","text-gray-500","dark:text-gray-400"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"],["type","text","matInput","","placeholder","Search Tickets",1,"block","w-full","p-4","ps-10","text-sm","text-gray-900","border","border-gray-300","rounded-lg","bg-gray-50","focus:ring-blue-500","focus:border-blue-500","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500",3,"keyup"],["role","status","class","p-5 animate-pulse",4,"ngIf"],[1,"w-full","overflow-auto","whitespace-nowrap","mt-5"],["matSort","","class","min-w-192",3,"dataSource",4,"ngIf"],["class","py-10",4,"ngIf"],[3,"pageSize","pageSizeOptions","showFirstLastButtons"],["role","status",1,"p-5","animate-pulse"],[1,"h-6","bg-gray-300","rounded-full","dark:bg-gray-700","w-full","mb-[22px]"],[1,"h-6","bg-gray-300","rounded-full","dark:bg-gray-700","w-full"],["matSort","",1,"min-w-192",3,"dataSource"],["matColumnDef","tracking_id"],[4,"matHeaderCellDef"],["class","text-lg whitespace-nowrap",4,"matCellDef"],["matColumnDef","category"],["class","flex items-center gap-3 py-5",4,"matCellDef"],["matColumnDef","product"],["matColumnDef","deleted_by"],["matColumnDef","deleted_at"],["class","flex items-center gap-3",4,"matCellDef"],["matColumnDef","action"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"text-lg","whitespace-nowrap"],[1,"flex","items-center","gap-3","py-5"],[1,"flex","items-center","gap-3"],["mat-sort-header",""],["class","flex items-center",4,"ngIf"],[1,"flex","items-center"],[1,"font-medium","mx-1","text-white","dark:text-white","bg-yellow-500","hover:bg-yellow-600","rounded","hover:cursor-pointer","hover:underline",3,"click"],["svgIcon","restore",1,"text-white",2,"transform","scale(0.8)"],[1,"font-medium","mx-1","text-white","dark:text-white","bg-red-500","hover:cursor-pointer","hover:bg-red-600","rounded","hover:underline",3,"click"],["svgIcon","heroicons_solid:trash",1,"text-white",2,"transform","scale(0.7)"],[1,"py-10"],[1,"flex","flex-col","items-center"],["src","icons/not-found.jpg","alt","not-found.jpg",1,"h-64","bg-cover","bg-center","object-scale-down"],[1,"text-lg","font-semibold"],[1,"text-sm"]],template:function(u,g){1&u&&e.DNE(0,ce,18,7,"section",2),2&u&&e.Y8G("ngIf",g.isAdmin)},dependencies:[f.MD,f.bT,T.Ou,T.iy,E.hM,d.tP,d.Zl,d.tL,d.ji,d.cC,d.YV,d.iL,d.KS,d.$R,d.YZ,d.NB,N.X1,v.fS,v.fg,I.NQ,I.B4,I.aE,y.Cn,S.g7,N.YN,m.An]})}}return r})();var de=n(68589),ue=n(69924);const pe=()=>["/dashboards/home"];let fe=(()=>{class r{constructor(l){this._ticketTableService=l,this._ticketTableService.fetchData()}static{this.\u0275fac=function(u){return new(u||r)(e.rXU(M.M))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-tickets"]],standalone:!0,features:[e.aNF],decls:18,vars:2,consts:[[1,"p-4","h-full","w-full","sm:px-5"],[1,"px-1","pt-3","flex","justify-between","items-start","sm:items-center","flex-col","sm:flex-row","gap-5","sm:gap-0"],[1,"font-bold","text-lg","sm:text-3xl"],[1,"text-sm","sm:text-base"],[1,"text-sm","text-gray-600"],[1,"font-medium","text-gray-500","hover:cursor-pointer","hover:text-blue-400",3,"routerLink"],[1,"mx-2","text-gray-400"],[1,"font-semibold","text-blue-600","hover:text-blue-500"],[1,"h-fit","w-full"]],template:function(u,g){1&u&&(e.j41(0,"main",0)(1,"div",1)(2,"div")(3,"h1",2),e.EFF(4,"Tickets"),e.k0s(),e.j41(5,"p",3),e.EFF(6,"Keep track of ongoing tickets and follow up efficiently."),e.k0s()(),e.j41(7,"div",4)(8,"span",5),e.EFF(9,"Home"),e.k0s(),e.j41(10,"span",6),e.EFF(11,"/"),e.k0s(),e.j41(12,"span",7),e.EFF(13,"Tickets"),e.k0s()()(),e.j41(14,"div",8),e.nrm(15,"app-ticket")(16,"app-ticket-logs")(17,"app-temp-tickets"),e.k0s()()),2&u&&(e.R7$(8),e.Y8G("routerLink",e.lJ4(1,pe)))},dependencies:[ue.U,de.V,C.Wk,me],encapsulation:2,changeDetection:0})}}return r})();var _e=n(25798),he=n(96697),ge=n(96354);const ke=[{path:"",component:fe},{path:"add-tickets",canActivate:[(r,h)=>{const l=(0,e.WQX)(C.Ix),u=(0,e.WQX)(_e.D),g="admin"===localStorage.getItem("userRole");return u.user$.pipe((0,he.s)(1),(0,ge.T)(b=>!(!g&&"Active Shift"!==b.shift_status)||l.parseUrl("/dashboards/tickets")))}],loadChildren:()=>Promise.all([n.e(6233),n.e(2076),n.e(789)]).then(n.bind(n,10789))},{path:":trackingId",loadChildren:()=>Promise.all([n.e(6233),n.e(1526)]).then(n.bind(n,21526))},{path:"places/:places_name",loadChildren:()=>n.e(4922).then(n.bind(n,44922))},{path:"category/:category_name",loadChildren:()=>n.e(6123).then(n.bind(n,66123))},{path:"users/:users_name",loadChildren:()=>n.e(6036).then(n.bind(n,86036))}]},48807:(z,L,n)=>{n.d(L,{X:()=>N});var C=n(10467),k=n(54438),e=n(3366),f=n(45794);let N=(()=>{class S{constructor(v,y){this._apiService=v,this._toastService=y,this._data=(0,k.vPA)([]),this.isLoading=(0,k.vPA)(!1),this.isNotFound=(0,k.vPA)(!1)}fetchData(){var v=this;return(0,C.A)(function*(){v.isLoading.set(!0),v._apiService.get("api/V1/tickets/temp").then(function(){var y=(0,C.A)(function*(T){v.isLoading.set(!1),v.isNotFound.set(!1),v._data.set(T.data),null!==T.data&&0!=T.data.length||v.isNotFound.set(!0)});return function(T){return y.apply(this,arguments)}}()).catch(function(){var y=(0,C.A)(function*(T){v.isLoading.set(!1),v.isNotFound.set(!0),v._toastService.error("Failed to fetch data","Error")});return function(T){return y.apply(this,arguments)}}())})()}static{this.\u0275fac=function(y){return new(y||S)(k.KVO(e.G),k.KVO(f.tw))}}static{this.\u0275prov=k.jDH({token:S,factory:S.\u0275fac,providedIn:"root"})}}return S})()},69924:(z,L,n)=>{n.d(L,{U:()=>He});var C=n(10467),k=n(60177),e=n(54438),f=n(89417),N=n(82765),S=n(86600),E=n(25084),v=n(75351),y=n(53719),T=n(99213),I=n(59042),d=n(59115),m=n(96695),_=n(82798),V=n(2042),D=n(9159),Q=n(21413),M=n(88834),Z=n(74710),q=n(40171),X=n(5271),W=n(62288),P=n(3366),H=n(45794),A=n(35883),B=n(10801),J=n(46601);let ee=(()=>{class i{constructor(t,o,a,c,x,j,w){this._apiService=t,this.toast=o,this._ticketTableSerivce=a,this._ticketLogsTableService=c,this.fuseConfirmationService=x,this.dialogRef=j,this.data=w,this.isLoading=!1,this.excelData=[],this.selectedFile=null}ngOnInit(){}formatDate(t){const o=new Date(t.getTime()+6e4*t.getTimezoneOffset());return`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getDate()+1).padStart(2,"0")}`}formatTime(t){return`${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`}onFileChange(t){const o=t.target.files[0];if(o){this.selectedFile=o;const a=new FileReader;a.onload=c=>{const x=new Uint8Array(c.target.result),j=W.LF(x,{type:"array",cellDates:!0});this.excelData=W.Wp.sheet_to_json(j.Sheets[j.SheetNames[0]]),this.excelData=this.excelData.map(F=>({...F,hari_masuk:F.hari_masuk instanceof Date?this.formatDate(F.hari_masuk):F.hari_masuk,hari_respon:F.hari_respon instanceof Date?this.formatDate(F.hari_respon):F.hari_respon,waktu_masuk:F.waktu_masuk instanceof Date?this.formatTime(F.waktu_masuk):F.waktu_masuk,waktu_respon:F.waktu_respon instanceof Date?this.formatTime(F.waktu_respon):F.waktu_respon})),console.log("Formatted Excel Data:",this.excelData)},a.readAsArrayBuffer(o)}}onSubmit(){var t=this;return(0,C.A)(function*(){if(t.selectedFile)if(t.excelData&&0!==t.excelData.length)try{t.isLoading=!0,console.log(t.excelData);const{status:a}=yield t._apiService.post("api/V1/tickets/excel",t.excelData);if(201===a)return t.toast.success("Success Create Tickets","Success"),t._ticketTableSerivce.fetchData(),t._ticketLogsTableService.fetchDatas(),t.dialogRef.close(),void(t.isLoading=!1);if(500===a)return t.toast.error("Internal Server Error","Failed"),t.dialogRef.close(),void(t.isLoading=!1);if(409===a)t.isLoading=!1,t.fuseConfirmationService.open({title:"Notification",message:"The Tickets already exists on the server. Would you like to create another Tickets time anyway?",icon:{color:"info"},actions:{confirm:{label:"Confirmation",color:"primary"}}});else if(400===a)return t.toast.error("Bad Request","Failed"),t.dialogRef.close(),void(t.isLoading=!1)}catch(o){throw o}else t.toast.warning("The selected file is empty or invalid.","Warning");else t.toast.warning("Please select a file before submitting.","Warning")})()}static{this.\u0275fac=function(o){return new(o||i)(e.rXU(P.G),e.rXU(H.tw),e.rXU(A.M),e.rXU(B.j),e.rXU(J.G),e.rXU(v.CP),e.rXU(v.Vh))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-import-excel"]],standalone:!0,features:[e.aNF],decls:26,vars:2,consts:[[1,"h-full","w-full","flex","flex-col"],[1,"flex","justify-between","p-2"],[1,"truncate","text-lg","font-medium","leading-6","tracking-tight","px-5","py-3","flex","flex-col","items-start","w-full","justify-between"],[1,"mb-2","text-2xl","font-semibold","sm:mb-0"],[1,"text-sm","text-gray-500"],["href","files/template_ticket_import.xlsx","download","",1,"text-blue-600","underline"],[3,"click"],["svgIcon","mat_solid:close",1,"cursor-pointer"],["message","Sumbitting Form...","spinner","circular",3,"isOpen"],[1,""],[1,"bg-card","flex","flex-col","overflow-hidden","rounded-2xl","px-8","py-4","pb-4","gap-5"],[1,"flex","flex-col","gap-2"],["for","excelFile",1,"text-sm","font-medium","text-gray-700","mb-1"],[1,"flex","items-center","border","border-gray-300","rounded-lg","px-4","py-2","cursor-pointer","hover:border-blue-500"],["type","file","id","excelFile","accept",".xlsx, .xls",1,"hidden",3,"change"],["for","excelFile",1,"flex-1","text-gray-600","cursor-pointer"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-6","w-6","text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M12 12v6m0 0l3-3m-3 3l-3-3M16 8V4H8v4"],["type","submit",1,"bg-green-600","text-white","p-2","rounded",3,"click"]],template:function(o,a){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),e.EFF(4,"Import Excel"),e.k0s(),e.j41(5,"p",4),e.EFF(6," Upload an Excel file. "),e.j41(7,"a",5),e.EFF(8,"Download here"),e.k0s(),e.EFF(9,". "),e.k0s()(),e.j41(10,"a",6),e.bIt("click",function(){return a.dialogRef.close()}),e.nrm(11,"mat-icon",7),e.k0s()(),e.nrm(12,"ion-loading",8),e.j41(13,"div",9)(14,"form",10)(15,"div",11)(16,"label",12),e.EFF(17,"Upload Excel File"),e.k0s(),e.j41(18,"div",13)(19,"input",14),e.bIt("change",function(x){return a.onFileChange(x)}),e.k0s(),e.j41(20,"label",15),e.EFF(21),e.k0s(),e.qSk(),e.j41(22,"svg",16),e.nrm(23,"path",17),e.k0s()()(),e.joV(),e.j41(24,"button",18),e.bIt("click",function(){return a.onSubmit()}),e.EFF(25," Import Excel "),e.k0s()()()()),2&o&&(e.R7$(12),e.Y8G("isOpen",a.isLoading),e.R7$(9),e.SpI(" ",a.selectedFile?a.selectedFile.name:"Choose Excel file..."," "))},dependencies:[f.X1,f.qT,f.cb,f.YN,f.cV,y.RG,I.fS,M.Hl,T.m_,T.An,X.rQ,E.X6,S.Sy,_.Ve,k.MD]})}}return i})();function te(i,s){if(1&i&&(e.j41(0,"mat-option",15),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}let ae=(()=>{class i{constructor(t,o,a,c,x,j,w,R){this._apiService=t,this.fb=o,this.toast=a,this.fuseConfirmationService=c,this._ticketTableService=x,this._ticketLogsService=j,this.dialogRef=w,this.data=R,this.isLoading=!1}ngOnInit(){this.productsForm=this.fb.group({note_resolved:[null,[f.k0.required]],category_resolved_id:[null,[f.k0.required]]}),this.fetchData()}fetchData(){var t=this;return(0,C.A)(function*(){try{const o=yield t._apiService.get("api/V1/category-resolved");t.categoryResolved=o.data}catch(o){console.error("Error fetching data:",o)}})()}onSubmit(){var t=this;return(0,C.A)(function*(){if(t.productsForm.invalid)t.toast.warning("Please Fill All Form","Warning");else try{t.isLoading=!0;const{status:a}=yield t._apiService.post(`api/V1/tickets-resolved/${t.data.tracking_id}`,{note_resolved:t.productsForm.value.note_resolved,category_resolved_id:t.productsForm.value.category_resolved_id});if(200===a)return t.toast.success("Success Resolved Tickets","Success"),t._ticketLogsService.fetchDatas(),t._ticketTableService.fetchData(),t.dialogRef.close(),void(t.isLoading=!1);if(500===a)return t.toast.error("Internal Server Error","Failed"),t.dialogRef.close(),void(t.isLoading=!1);409===a&&(t.isLoading=!1,t.fuseConfirmationService.open({title:"Notification",message:"The Products already exists on the server. Would you like to create another Products time anyway?",icon:{color:"info"},actions:{confirm:{label:"Confirmation",color:"primary"}}}))}catch(o){throw o}})()}static{this.\u0275fac=function(o){return new(o||i)(e.rXU(P.G),e.rXU(f.ok),e.rXU(H.tw),e.rXU(J.G),e.rXU(A.M),e.rXU(B.j),e.rXU(v.CP),e.rXU(v.Vh))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-form-resolved"]],standalone:!0,features:[e.aNF],decls:21,vars:3,consts:[[1,"h-full","w-full","flex","flex-col"],[1,"flex","justify-between","p-2"],[1,"truncate","text-lg","font-medium","leading-6","tracking-tight","px-5","py-3","flex","flex-col","sm:flex-row","items-start","sm:items-center","w-full","justify-between"],[1,"mb-2","text-xl","font-semibold","sm:mb-0"],[3,"click"],["svgIcon","mat_solid:close",1,"cursor-pointer"],["message","Sumbitting Form...","spinner","circular",3,"isOpen"],[1,""],[1,"bg-card","flex","flex-col","overflow-hidden","rounded-2xl","px-8","pt-2","pb-4",3,"formGroup"],["floatLabel","always",1,"w-full","pb-4"],["formControlName","category_resolved_id","placeholder","Select Products"],["class","px-3 py-1 m-2 font-medium text-base rounded-full",3,"value",4,"ngFor","ngForOf"],[1,"w-full","pb-4"],["matInput","","formControlName","note_resolved","rows","4","placeholder","Note Resolved"],["type","submit",1,"bg-green-600","text-white","p-2","rounded",3,"click"],[1,"px-3","py-1","m-2","font-medium","text-base","rounded-full",3,"value"]],template:function(o,a){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),e.EFF(4,"Resolved Tickets"),e.k0s()(),e.j41(5,"a",4),e.bIt("click",function(){return a.dialogRef.close()}),e.nrm(6,"mat-icon",5),e.k0s()(),e.nrm(7,"ion-loading",6),e.j41(8,"div",7)(9,"form",8)(10,"mat-form-field",9)(11,"mat-label"),e.EFF(12,"Category Resolved"),e.k0s(),e.j41(13,"mat-select",10),e.DNE(14,te,2,2,"mat-option",11),e.k0s()(),e.j41(15,"mat-form-field",12)(16,"mat-label"),e.EFF(17,"Resolved Note"),e.k0s(),e.nrm(18,"textarea",13),e.k0s(),e.j41(19,"button",14),e.bIt("click",function(){return a.onSubmit()}),e.EFF(20," Add Category "),e.k0s()()()()),2&o&&(e.R7$(7),e.Y8G("isOpen",a.isLoading),e.R7$(2),e.Y8G("formGroup",a.productsForm),e.R7$(5),e.Y8G("ngForOf",a.categoryResolved))},dependencies:[f.X1,f.qT,f.me,f.BC,f.cb,f.j4,f.JD,f.YN,y.RG,y.rl,y.nJ,I.fS,I.fg,M.Hl,T.m_,T.An,X.rQ,E.X6,S.Sy,S.wT,_.Ve,_.VO,k.MD,k.Sq]})}}return i})();const ie=()=>["/dashboards/tickets/add-tickets"],G=()=>({disableClose:!0}),ne=()=>[5,10,20],oe=(i,s,t,o)=>({"bg-blue-500":i,"bg-yellow-500":s,"bg-[#7D7D7D]":t,"bg-green-500":o}),K=(i,s,t,o)=>({"text-green-600":i,"text-blue-600":s,"text-yellow-600":t,"text-red-600":o}),se=i=>["/dashboards/tickets",i];function re(i,s){if(1&i){const t=e.RV6();e.j41(0,"button",54),e.bIt("click",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.importExcel())}),e.nrm(1,"mat-icon",55),e.j41(2,"span"),e.EFF(3,"Import Excel"),e.k0s()()}}function le(i,s){if(1&i){const t=e.RV6();e.j41(0,"mat-checkbox",56),e.mxI("ngModelChange",function(a){const c=e.eBV(t).$implicit;return e.DH7(c.checked,a)||(c.checked=a),e.Njj(a)}),e.bIt("click",function(a){return e.eBV(t),e.Njj(a.stopPropagation())})("change",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.applyProductsFilter())}),e.EFF(1),e.k0s()}if(2&i){const t=s.$implicit;e.R50("ngModel",t.checked),e.R7$(),e.SpI(" ",t.name," ")}}function ce(i,s){if(1&i){const t=e.RV6();e.j41(0,"mat-checkbox",56),e.mxI("ngModelChange",function(a){const c=e.eBV(t).$implicit;return e.DH7(c.checked,a)||(c.checked=a),e.Njj(a)}),e.bIt("click",function(a){return e.eBV(t),e.Njj(a.stopPropagation())})("change",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.applyPlacesFilter())}),e.EFF(1),e.k0s()}if(2&i){const t=s.$implicit;e.R50("ngModel",t.checked),e.R7$(),e.SpI(" ",t.name," ")}}function me(i,s){if(1&i){const t=e.RV6();e.j41(0,"mat-checkbox",57),e.mxI("ngModelChange",function(a){const c=e.eBV(t).$implicit;return e.DH7(c.checked,a)||(c.checked=a),e.Njj(a)}),e.bIt("click",function(a){return e.eBV(t),e.Njj(a.stopPropagation())})("change",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.applyCategoryFilter())}),e.EFF(1),e.k0s()}if(2&i){const t=s.$implicit;e.R50("ngModel",t.checked),e.R7$(),e.JRh(t.name)}}function de(i,s){if(1&i){const t=e.RV6();e.j41(0,"mat-checkbox",56),e.mxI("ngModelChange",function(a){const c=e.eBV(t).$implicit;return e.DH7(c.checked,a)||(c.checked=a),e.Njj(a)}),e.bIt("click",function(a){return e.eBV(t),e.Njj(a.stopPropagation())})("change",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.applyStatusFilter())}),e.j41(1,"div",58)(2,"h1",59),e.EFF(3),e.k0s()()()}if(2&i){const t=s.$implicit;e.R50("ngModel",t.checked),e.R7$(),e.Y8G("ngClass",e.ziG(3,oe,"New"===t.name,"On Progress"===t.name,"Hold"===t.name,"Resolved"===t.name)),e.R7$(2),e.JRh(t.name)}}function ue(i,s){if(1&i){const t=e.RV6();e.j41(0,"mat-checkbox",56),e.mxI("ngModelChange",function(a){const c=e.eBV(t).$implicit;return e.DH7(c.checked,a)||(c.checked=a),e.Njj(a)}),e.bIt("click",function(a){return e.eBV(t),e.Njj(a.stopPropagation())})("change",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.applyPriorityFilter())}),e.j41(1,"div",19),e.nrm(2,"mat-icon",60),e.j41(3,"h1",61),e.EFF(4),e.k0s()()()}if(2&i){const t=s.$implicit;e.R50("ngModel",t.checked),e.R7$(2),e.Y8G("ngClass",e.ziG(3,K,"Low"===t.name,"Hedium"===t.name,"High"===t.name,"Critical"===t.name)),e.R7$(2),e.JRh(t.name)}}function pe(i,s){1&i&&(e.j41(0,"div",62),e.nrm(1,"div",63)(2,"div",63)(3,"div",63)(4,"div",63)(5,"div",63)(6,"div",63)(7,"div",64),e.k0s())}function fe(i,s){1&i&&(e.j41(0,"mat-header-cell"),e.EFF(1," Tracking ID "),e.k0s())}function _e(i,s){if(1&i&&(e.j41(0,"mat-cell",92)(1,"a",93),e.EFF(2),e.k0s()()),2&i){const t=s.$implicit;e.R7$(),e.Y8G("routerLink",e.eq3(2,se,t.tracking_id)),e.R7$(),e.JRh(t.tracking_id)}}function he(i,s){1&i&&(e.j41(0,"mat-header-cell"),e.EFF(1," Ticket Entry Day "),e.k0s())}function ge(i,s){if(1&i&&(e.j41(0,"mat-cell",19),e.nrm(1,"mat-icon",94),e.EFF(2),e.k0s()),2&i){const t=s.$implicit;e.R7$(2),e.SpI(" ",t.hari_masuk," ")}}function Te(i,s){1&i&&(e.j41(0,"mat-header-cell"),e.EFF(1," Ticket Entry Time "),e.k0s())}function ke(i,s){if(1&i&&(e.j41(0,"mat-cell",19),e.nrm(1,"mat-icon",95),e.EFF(2),e.k0s()),2&i){const t=s.$implicit;e.R7$(2),e.SpI(" ",t.waktu_masuk," ")}}function r(i,s){1&i&&(e.j41(0,"mat-header-cell"),e.EFF(1," Place "),e.k0s())}function h(i,s){if(1&i&&(e.j41(0,"mat-cell",96),e.EFF(1),e.k0s()),2&i){let t;const o=s.$implicit;e.R7$(),e.SpI(" ",null!==(t=o.places_name)&&void 0!==t?t:"Not Found"," ")}}function l(i,s){1&i&&(e.j41(0,"mat-header-cell"),e.EFF(1," Category "),e.k0s())}function u(i,s){if(1&i&&(e.j41(0,"mat-cell",96),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.R7$(),e.SpI(" ",t.category," ")}}function g(i,s){1&i&&(e.j41(0,"mat-header-cell"),e.EFF(1," Users "),e.k0s())}function b(i,s){1&i&&(e.j41(0,"div",62),e.nrm(1,"div",63),e.k0s())}function O(i,s){if(1&i&&(e.j41(0,"mat-cell",97)(1,"div",98),e.nrm(2,"img",99),e.j41(3,"p",59),e.EFF(4),e.k0s()()()),2&i){const t=s.$implicit;e.R7$(2),e.Y8G("src",t.user.avatar,e.B4B),e.R7$(2),e.JRh(t.user.name)}}function ve(i,s){1&i&&(e.j41(0,"mat-header-cell"),e.EFF(1," PIC "),e.k0s())}function Fe(i,s){if(1&i&&(e.j41(0,"mat-cell"),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.R7$(),e.SpI(" ",""==(null==t?null:t.pic)||null==(null==t?null:t.pic)?"Not Found":t.pic," ")}}function be(i,s){1&i&&(e.j41(0,"mat-header-cell"),e.EFF(1," Subject "),e.k0s())}function ye(i,s){if(1&i&&(e.j41(0,"mat-cell",100),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.R7$(),e.SpI(" ",t.subject," ")}}function Ce(i,s){1&i&&(e.j41(0,"mat-header-cell"),e.EFF(1," Whatsapp Client "),e.k0s())}function Se(i,s){if(1&i&&(e.j41(0,"mat-cell")(1,"a",101),e.EFF(2),e.k0s()()),2&i){const t=s.$implicit;e.R7$(),e.Y8G("href","https://wa.me/"+(null==t?null:t.no_whatsapp),e.B4B),e.R7$(),e.SpI(" ",""===(null==t?null:t.no_whatsapp)?"Not Found":t.no_whatsapp," ")}}function je(i,s){1&i&&(e.j41(0,"mat-header-cell"),e.EFF(1," Status "),e.k0s())}function De(i,s){if(1&i&&(e.j41(0,"mat-option",106),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.Y8G("value",t),e.R7$(),e.SpI(" ",t," ")}}function we(i,s){if(1&i){const t=e.RV6();e.j41(0,"mat-cell",102)(1,"mat-form-field",103)(2,"mat-select",104),e.mxI("valueChange",function(a){const c=e.eBV(t).$implicit;return e.DH7(c.status,a)||(c.status=a),e.Njj(a)}),e.bIt("selectionChange",function(a){const c=e.eBV(t).$implicit,x=e.XpG(2);return e.Njj(x.onStatusChange(a.value,c))}),e.DNE(3,De,2,2,"mat-option",105),e.k0s()()()}if(2&i){const t=s.$implicit,o=e.XpG(2);e.R7$(2),e.R50("value",t.status),e.Y8G("disabled",!o.isAdmin&&(o.shiftStatus||"Resolved"===(null==t?null:t.status))),e.R7$(),e.Y8G("ngForOf",o.statusList)}}function Ee(i,s){1&i&&(e.j41(0,"mat-header-cell"),e.EFF(1," Solved Time "),e.k0s())}function Re(i,s){if(1&i&&(e.j41(0,"mat-cell"),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.R7$(),e.SpI(" ",""===t.solved_time||null===t.solved_time?"On Progress":t.solved_time,"")}}function Ie(i,s){1&i&&(e.j41(0,"mat-header-cell"),e.EFF(1," Last Replier "),e.k0s())}function Ne(i,s){1&i&&(e.j41(0,"div",62),e.nrm(1,"div",63),e.k0s())}function $e(i,s){if(1&i&&(e.j41(0,"mat-cell",107)(1,"div",98),e.nrm(2,"img",108),e.j41(3,"p",59),e.EFF(4),e.k0s()()()),2&i){const t=s.$implicit;e.R7$(2),e.Y8G("src",null===t.last_replier?t.user.avatar:t.last_replier.avatar,e.B4B),e.R7$(2),e.JRh(null===t.last_replier?t.user.name:t.last_replier.name)}}function Le(i,s){1&i&&(e.j41(0,"mat-header-cell"),e.EFF(1," Priority "),e.k0s())}function Me(i,s){if(1&i&&(e.j41(0,"mat-cell",19),e.nrm(1,"mat-icon",60),e.j41(2,"h1",61),e.EFF(3),e.k0s()()),2&i){const t=s.$implicit;e.R7$(),e.Y8G("ngClass",e.ziG(2,K,"Low"===t.priority,"Medium"===t.priority,"High"===t.priority,"Critical"===t.priority)),e.R7$(2),e.JRh(t.priority)}}function Ge(i,s){1&i&&(e.j41(0,"mat-header-cell"),e.EFF(1," Created Date "),e.k0s())}function Ve(i,s){if(1&i&&(e.j41(0,"mat-cell",19),e.nrm(1,"mat-icon",94),e.EFF(2),e.k0s()),2&i){const t=s.$implicit;e.R7$(2),e.SpI(" ",t.created_date," ")}}function Pe(i,s){1&i&&(e.j41(0,"mat-header-cell"),e.EFF(1," Created Time "),e.k0s())}function Ae(i,s){if(1&i&&(e.j41(0,"mat-cell",19),e.nrm(1,"mat-icon",95),e.EFF(2),e.k0s()),2&i){const t=s.$implicit;e.R7$(2),e.SpI(" ",t.created_time," ")}}function Be(i,s){1&i&&e.nrm(0,"mat-header-row")}function Oe(i,s){1&i&&e.nrm(0,"mat-row")}function Ye(i,s){if(1&i&&(e.j41(0,"mat-table",65,9)(2,"div"),e.qex(3,66),e.DNE(4,fe,2,0,"mat-header-cell",67)(5,_e,3,4,"mat-cell",68),e.bVm(),e.qex(6,69),e.DNE(7,he,2,0,"mat-header-cell",67)(8,ge,3,1,"mat-cell",70),e.bVm(),e.qex(9,71),e.DNE(10,Te,2,0,"mat-header-cell",67)(11,ke,3,1,"mat-cell",70),e.bVm(),e.qex(12,72),e.DNE(13,r,2,0,"mat-header-cell",67)(14,h,2,1,"mat-cell",73),e.bVm(),e.qex(15,74),e.DNE(16,l,2,0,"mat-header-cell",67)(17,u,2,1,"mat-cell",73),e.bVm(),e.qex(18,75),e.DNE(19,g,2,0,"mat-header-cell",67)(20,b,2,0,"div",49)(21,O,5,2,"mat-cell",76),e.bVm(),e.qex(22,77),e.DNE(23,ve,2,0,"mat-header-cell",67)(24,Fe,2,1,"mat-cell",78),e.bVm(),e.qex(25,79),e.DNE(26,be,2,0,"mat-header-cell",67)(27,ye,2,1,"mat-cell",80),e.bVm(),e.qex(28,81),e.DNE(29,Ce,2,0,"mat-header-cell",67)(30,Se,3,2,"mat-cell",78),e.bVm(),e.qex(31,82),e.DNE(32,je,2,0,"mat-header-cell",67)(33,we,4,3,"mat-cell",83),e.bVm(),e.qex(34,84),e.DNE(35,Ee,2,0,"mat-header-cell",67)(36,Re,2,1,"mat-cell",78),e.bVm(),e.qex(37,85),e.DNE(38,Ie,2,0,"mat-header-cell",67)(39,Ne,2,0,"div",49)(40,$e,5,2,"mat-cell",86),e.bVm(),e.qex(41,87),e.DNE(42,Le,2,0,"mat-header-cell",67)(43,Me,4,7,"mat-cell",70),e.bVm(),e.qex(44,88),e.DNE(45,Ge,2,0,"mat-header-cell",67)(46,Ve,3,1,"mat-cell",70),e.bVm(),e.qex(47,89),e.DNE(48,Pe,2,0,"mat-header-cell",67)(49,Ae,3,1,"mat-cell",70),e.bVm(),e.DNE(50,Be,1,0,"mat-header-row",90)(51,Oe,1,0,"mat-row",91),e.k0s()()),2&i){const t=e.XpG();e.Y8G("dataSource",t.dataSource),e.R7$(20),e.Y8G("ngIf",t.isLoading),e.R7$(19),e.Y8G("ngIf",t.isLoading),e.R7$(11),e.Y8G("matHeaderRowDef",t.displayedColumns),e.R7$(),e.Y8G("matRowDefColumns",t.displayedColumns)}}function Ue(i,s){1&i&&(e.j41(0,"div",109)(1,"div",110),e.nrm(2,"img",111)(3,"br"),e.j41(4,"p",112),e.EFF(5,"Data Not Found"),e.k0s(),e.j41(6,"p",113),e.EFF(7,"try using a different keyword or add a new tickets"),e.k0s()()())}const xe=new Date,Xe=xe.getMonth(),We=xe.getFullYear();xe.getDay();let He=(()=>{class i{constructor(t,o,a,c,x){this._apiService=t,this.cdr=o,this._ticketLogsService=a,this._ticketTableService=c,this._matDialog=x,this.filterValues={search:"",category:[],products:[],places:[],status:[],priority:[]},this.shiftStatus=!0,this.ticketStatus=!1,this.isAdmin="admin"===localStorage.getItem("userRole"),this.statusList=["New","Hold","On Progress","Resolved"],this.productsItems=[],this.category=[],this.statusItems=[],this.priorityItems=[],this.placesItems=[],this._unsubscribeAll=new Q.B,this.displayedColumns=["tracking_id","hari_masuk","waktu_masuk","place","name","category","subject","pic","no_whatsapp","status","solved_time","last_replier","priority","create_date","create_time"],this.dataSource=new D.I6,this.range=new f.gE({start:new f.MJ(new Date(We,Xe-1)),end:new f.MJ(new Date)}),this._ticketTableService.checkTickets(),(0,e.QZP)(()=>{const j=this.datas,w=new Set,R=new Set,F=new Set,Y=new Set,U=new Set;j.forEach(p=>{p.products_name&&(Array.isArray(p.products_name)?p.products_name.forEach($=>Y.add($)):Y.add(p.products_name)),p.places_name&&(Array.isArray(p.places_name)?p.places_name.forEach($=>U.add($)):U.add(p.places_name)),p.category&&(Array.isArray(p.category)?p.category.forEach($=>w.add($)):(w.add(p.category),R.add(p.status))),p.status&&(Array.isArray(p.status)?p.status.forEach($=>R.add($)):R.add(p.status)),p.priority&&(Array.isArray(p.priority)?p.priority.forEach($=>F.add($)):F.add(p.priority)),p.subject||(p.subject="Subject Not Found")}),this.statusItems=[...R].map(p=>({name:p,checked:!1})),this.category=[...w].map(p=>({name:p,checked:!1})),this.priorityItems=[...F].map(p=>({name:p,checked:!1})),this.productsItems=[...Y].map(p=>({name:p,checked:!1})),this.placesItems=[...U].map(p=>({name:p,checked:!1})),this.dataSource.data=0!==this._ticketTableService._datas().length?j.map(p=>({...p,originalStatus:p.status})):[]})}get datas(){return this._ticketTableService._datas()}get isLoading(){return this._ticketTableService.isLoading()}get isNotFound(){return this._ticketTableService.isNotFound()}ngOnInit(){this.fetchUsers(),this.range.valueChanges.subscribe(({start:t,end:o})=>{if(o){const a=t instanceof Date?t:new Date(t),c=o instanceof Date?o:new Date(o);this._ticketTableService.fetchDataByDate(a.toLocaleDateString("en-CA"),c.toLocaleDateString("en-CA"))}})}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}importExcel(){this._matDialog.open(ee,{width:window.innerWidth<600?"90%":"50%",maxWidth:"100vw"})}resolvedTickets(t){this._matDialog.open(ae,{width:window.innerWidth<600?"90%":"50%",maxWidth:"100vw",data:t})}generateReport(){this._matDialog.open(q.E,{width:window.innerWidth<600?"90%":"50%",maxWidth:"100vw"})}fetchUsers(){var t=this;return(0,C.A)(function*(){try{const o=yield t._apiService.get("api/V1/get-profile");t.shiftStatus="Active Shift"!==o.data.shift_status,t.cdr.detectChanges()}catch(o){throw o}})()}applyFilter(){this.dataSource.filterPredicate=(t,o)=>{let a=JSON.parse(o);console.log(t);let c=""===a.search||t.tracking_id.toLowerCase().includes(a.search)||t.created_date.toLowerCase().includes(a.search)||t.created_time.toLowerCase().includes(a.search)||t.hari_masuk.toLowerCase().includes(a.search)||t.waktu_masuk.toLowerCase().includes(a.search)||t.products_name.toLowerCase().includes(a.search)||t.pic.toLowerCase().includes(a.search)||t.category.toLowerCase().includes(a.search)||t.subject.toLowerCase().includes(a.search)||t.status.toLowerCase().includes(a.search)||t.priority.toLowerCase().includes(a.search)||t.places_name.toLowerCase().includes(a.search)||t.no_whatsapp.toLowerCase().includes(a.search)||t.user?.name.toLowerCase().includes(a.search)||t.last_replier?.name.toLowerCase().includes(a.search),x=0===a.category.length||a.category.includes(t.category.toLowerCase()),j=0===a.status.length||a.status.includes(t.status.toLowerCase()),w=0===a.priority.length||a.priority.includes(t.priority.toLowerCase()),R=0===a.products.length||a.products.includes(t.products_name.toLowerCase()),F=0===a.places.length||a.places.includes((t.places_name||"").toLowerCase());return c&&x&&j&&w&&R&&F},this.dataSource.filter=JSON.stringify(this.filterValues)}applySearchFilter(t){this.filterValues.search=t.trim().toLowerCase(),this.applyFilter()}applyProductsFilter(){this.filterValues.products=this.productsItems.filter(t=>t.checked).map(t=>t.name.toLowerCase()),this.applyFilter()}applyPlacesFilter(){this.filterValues.places=this.placesItems.filter(t=>t.checked).map(t=>t.name.toLowerCase()),this.applyFilter()}applyCategoryFilter(){this.filterValues.category=this.category.filter(t=>t.checked).map(t=>t.name.toLowerCase()),this.applyFilter()}applyStatusFilter(){this.filterValues.status=this.statusItems.filter(t=>t.checked).map(t=>t.name.toLowerCase()),this.applyFilter()}applyPriorityFilter(){this.filterValues.priority=this.priorityItems.filter(t=>t.checked).map(t=>t.name.toLowerCase()),this.applyFilter()}onStatusChange(t,o){t!==o.originalStatus&&("Resolved"!==t?this.changeStatus(o.tracking_id,t):this.resolvedTickets(o))}changeStatus(t,o){var a=this;return(0,C.A)(function*(){try{const{status:c}=yield a._apiService.post(`api/V1/ticket-status/${t}`,{status:o});200===c&&(a._ticketLogsService.fetchDatas(),a._ticketTableService.fetchData())}catch(c){throw c}})()}static{this.\u0275fac=function(o){return new(o||i)(e.rXU(P.G),e.rXU(e.gRc),e.rXU(B.j),e.rXU(A.M),e.rXU(v.bZ))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-ticket"]],viewQuery:function(o,a){if(1&o&&(e.GBs(V.B4,5),e.GBs(m.iy,5)),2&o){let c;e.mGM(c=e.lsd())&&(a.sort=c.first),e.mGM(c=e.lsd())&&(a.paginator=c.first)}},standalone:!0,features:[e.aNF],decls:97,vars:40,consts:[["addUserMenu","matMenu"],["picker",""],["menu","matMenu"],["products","matMenu"],["places","matMenu"],["categorys","matMenu"],["status","matMenu"],["priority","matMenu"],["paginator",""],["table",""],[1,"h-fit","border-[1px]","shadow-xl","mt-4","bg-white","rounded-lg","p-5"],[1,"flex","flex-col","items-start","lg:flex-row","sm:items-center","justify-between"],[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","gap-3","w-1/3","max-lg:w-full"],["for","table-search",1,"sr-only"],[1,"relative","my-2","w-full"],[1,"absolute","inset-y-0","rtl:inset-r-0","start-0","flex","items-center","ps-3","pointer-events-none"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 20 20",1,"w-4","h-4","text-gray-500","dark:text-gray-400"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"],["type","text","matInput","","placeholder","Search Tickets",1,"block","w-full","p-4","ps-10","text-sm","text-gray-900","border","border-gray-300","rounded-lg","bg-gray-50","focus:ring-blue-500","focus:border-blue-500","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500",3,"keyup"],[1,"flex","items-center","gap-3"],["mat-raised-button","",1,"flex","w-fit","text-nowrap","items-center","gap-2","p-2.5","rounded-full","px-3","sm:px-5","text-white",3,"disabled","matMenuTriggerFor","ngClass"],[1,"flex","items-center","gap-1"],[1,"m-2","pr-4","border-r-[1px]"],["svgIcon","keyboard_arrow_down",1,"font-bold","text-2xl"],["mat-menu-item","",3,"routerLink"],["svgIcon","mat_outline:add",1,"icon-size-5"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-raised-button","",1,"flex","w-fit","text-nowrap","items-center","gap-2","p-2.5","rounded-full","px-3","sm:px-5","bg-red-500","text-white",3,"click"],["svgIcon","mat_solid:picture_as_pdf",1,"text-white"],[1,"max-sm:hidden","font-semibold"],[1,"min-w-[300px]","max-w-full","self-end","hidden","sm:block"],[1,"w-full",3,"rangePicker","formGroup"],["matStartDate","","formControlName","start","placeholder","Start date",1,"w-full"],["matEndDate","","formControlName","end","placeholder","End date",1,"w-full"],["matSuffix","",3,"for"],["touchUi",""],[1,"flex","items-center","gap-2","p-2.5","rounded-full","px-3","sm:px-5","border-[1px]","text-white",3,"matMenuTriggerFor"],["svgIcon","filter_alt"],[1,"max-sm:hidden","font-semibold","text-black"],["svgIcon","keyboard_arrow_down"],["mat-menu-item","",3,"matMenuTriggerFor","matMenuTriggerData"],[1,"min-w-[300px]"],[1,"px-5","py-3","w-full"],[1,"font-semibold","mb-2"],[1,"px-5","flex","flex-col","gap-2","w-full"],["class","h-full",3,"ngModel","ngModelChange","click","change",4,"ngFor","ngForOf"],["class","h-full w-full",3,"ngModel","ngModelChange","click","change",4,"ngFor","ngForOf"],[1,"px-5","py-3"],[1,"min-w-[300px]","max-w-full","pt-4","self-start","sm:hidden","block"],["role","status","class","p-5 animate-pulse",4,"ngIf"],[1,"w-full","overflow-auto","whitespace-nowrap","mt-5"],["matSort","","class","min-w-[2480px]",3,"dataSource",4,"ngIf"],["class","py-10",4,"ngIf"],[3,"pageSize","pageSizeOptions","showFirstLastButtons"],["mat-menu-item","",3,"click"],["svgIcon","mat_outline:upload_file",1,"icon-size-5"],[1,"h-full",3,"ngModelChange","click","change","ngModel"],[1,"h-full","w-full",3,"ngModelChange","click","change","ngModel"],[1,"px-3","py-1","text-white","whitespace-nowrap","rounded-full",3,"ngClass"],[1,"font-medium"],["svgIcon","mat_outline:bookmark",1,"-rotate-90",3,"ngClass"],[1,"font-medium","uppercase"],["role","status",1,"p-5","animate-pulse"],[1,"h-6","bg-gray-300","rounded-full","dark:bg-gray-700","w-full","mb-[22px]"],[1,"h-6","bg-gray-300","rounded-full","dark:bg-gray-700","w-full"],["matSort","",1,"min-w-[2480px]",3,"dataSource"],["matColumnDef","tracking_id"],[4,"matHeaderCellDef"],["class","text-lg text-blue-600 font-medium underline whitespace-nowrap",4,"matCellDef"],["matColumnDef","hari_masuk"],["class","flex items-center gap-3",4,"matCellDef"],["matColumnDef","waktu_masuk"],["matColumnDef","place"],["class","flex items-center gap-3 font-medium",4,"matCellDef"],["matColumnDef","category"],["matColumnDef","name"],["class","py-3.5 flex items-center gap-3 w-fit",4,"matCellDef"],["matColumnDef","pic"],[4,"matCellDef"],["matColumnDef","subject"],["class","font-bold text-lg",4,"matCellDef"],["matColumnDef","no_whatsapp"],["matColumnDef","status"],["class","py-4 w-full",4,"matCellDef"],["matColumnDef","solved_time"],["matColumnDef","last_replier"],["class","py-2 flex items-center gap-3 w-fit",4,"matCellDef"],["matColumnDef","priority"],["matColumnDef","create_date"],["matColumnDef","create_time"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"text-lg","text-blue-600","font-medium","underline","whitespace-nowrap"],[3,"routerLink"],["svgIcon","mat_solid:date_range"],["svgIcon","mat_outline:access_time"],[1,"flex","items-center","gap-3","font-medium"],[1,"py-3.5","flex","items-center","gap-3","w-fit"],[1,"w-full","flex","items-center","gap-3"],["alt","",1,"w-7","h-7","object-cover","rounded-full",3,"src"],[1,"font-bold","text-lg"],["target","_blank",3,"href"],[1,"py-4","w-full"],["hideRequiredMarker","",1,"w-full"],["placeholder","Select",3,"valueChange","selectionChange","value","disabled"],["class","px-3 py-1 m-2 font-medium text-base rounded-full",3,"value",4,"ngFor","ngForOf"],[1,"px-3","py-1","m-2","font-medium","text-base","rounded-full",3,"value"],[1,"py-2","flex","items-center","gap-3","w-fit"],["alt","",1,"w-7","h-7","rounded-full",3,"src"],[1,"py-10"],[1,"flex","flex-col","items-center"],["src","icons/not-found.jpg","alt","not-found.jpg",1,"h-64","bg-cover","bg-center","object-scale-down"],[1,"text-lg","font-semibold"],[1,"text-sm"]],template:function(o,a){if(1&o){const c=e.RV6();e.j41(0,"section",10)(1,"div",11)(2,"div",12)(3,"label",13),e.EFF(4,"Search"),e.k0s(),e.j41(5,"div",14)(6,"div",15),e.qSk(),e.j41(7,"svg",16),e.nrm(8,"path",17),e.k0s()(),e.joV(),e.j41(9,"input",18),e.bIt("keyup",function(j){return e.eBV(c),e.Njj(a.applySearchFilter(j.target.value))}),e.k0s()()(),e.j41(10,"div",19)(11,"button",20)(12,"div",21)(13,"span",22),e.EFF(14,"New Tickets"),e.k0s(),e.nrm(15,"mat-icon",23),e.k0s()(),e.j41(16,"mat-menu",null,0)(18,"button",24),e.nrm(19,"mat-icon",25),e.j41(20,"span"),e.EFF(21,"Add Tickets"),e.k0s()(),e.DNE(22,re,4,0,"button",26),e.k0s(),e.j41(23,"button",27),e.bIt("click",function(){return e.eBV(c),e.Njj(a.generateReport())}),e.nrm(24,"mat-icon",28),e.j41(25,"span",29),e.EFF(26,"Generate Report"),e.k0s()(),e.j41(27,"mat-form-field",30)(28,"mat-date-range-input",31),e.nrm(29,"input",32)(30,"input",33),e.k0s(),e.nrm(31,"mat-datepicker-toggle",34)(32,"mat-date-range-picker",35,1),e.k0s(),e.j41(34,"button",36),e.nrm(35,"mat-icon",37),e.j41(36,"span",38),e.EFF(37,"Filter"),e.k0s(),e.nrm(38,"mat-icon",39),e.k0s(),e.j41(39,"mat-menu",null,2)(41,"button",40),e.EFF(42,"Products"),e.k0s(),e.j41(43,"button",40),e.EFF(44,"Places"),e.k0s(),e.j41(45,"button",40),e.EFF(46,"Category"),e.k0s(),e.j41(47,"button",40),e.EFF(48,"Status"),e.k0s(),e.j41(49,"button",40),e.EFF(50,"Priority"),e.k0s(),e.j41(51,"mat-menu",41,3)(53,"div",42)(54,"h1",43),e.EFF(55,"Choose Products"),e.k0s()(),e.j41(56,"div",44),e.DNE(57,le,2,2,"mat-checkbox",45),e.k0s()(),e.j41(58,"mat-menu",41,4)(60,"div",42)(61,"h1",43),e.EFF(62,"Choose Places"),e.k0s()(),e.j41(63,"div",44),e.DNE(64,ce,2,2,"mat-checkbox",45),e.k0s()(),e.j41(65,"mat-menu",41,5)(67,"div",42)(68,"h1",43),e.EFF(69,"Choose Category"),e.k0s()(),e.j41(70,"div",44),e.DNE(71,me,2,2,"mat-checkbox",46),e.k0s()(),e.j41(72,"mat-menu",null,6)(74,"div",47)(75,"h1",43),e.EFF(76,"Choose status"),e.k0s()(),e.DNE(77,de,4,8,"mat-checkbox",45),e.k0s(),e.j41(78,"mat-menu",null,7)(80,"div",47)(81,"h1",43),e.EFF(82,"Choose Priority"),e.k0s()(),e.DNE(83,ue,5,8,"mat-checkbox",45),e.k0s()()(),e.j41(84,"mat-form-field",48)(85,"mat-date-range-input",31),e.nrm(86,"input",32)(87,"input",33),e.k0s(),e.nrm(88,"mat-datepicker-toggle",34)(89,"mat-date-range-picker",null,1),e.k0s()(),e.DNE(91,pe,8,0,"div",49),e.j41(92,"div",50),e.DNE(93,Ye,52,5,"mat-table",51),e.k0s(),e.DNE(94,Ue,8,0,"div",52),e.nrm(95,"mat-paginator",53,8),e.k0s()}if(2&o){const c=e.sdS(17),x=e.sdS(33),j=e.sdS(40),w=e.sdS(52),R=e.sdS(59),F=e.sdS(66),Y=e.sdS(73),U=e.sdS(79);e.R7$(11),e.Y8G("disabled",a.shiftStatus&&!a.isAdmin)("matMenuTriggerFor",c)("ngClass",a.shiftStatus&&!a.isAdmin?"bg-gray-400":"bg-primary"),e.R7$(7),e.Y8G("routerLink",e.lJ4(33,ie)),e.R7$(4),e.Y8G("ngIf",a.isAdmin),e.R7$(6),e.Y8G("rangePicker",x)("formGroup",a.range),e.R7$(3),e.Y8G("for",x),e.R7$(3),e.Y8G("matMenuTriggerFor",j),e.R7$(7),e.Y8G("matMenuTriggerFor",w)("matMenuTriggerData",e.lJ4(34,G)),e.R7$(2),e.Y8G("matMenuTriggerFor",R)("matMenuTriggerData",e.lJ4(35,G)),e.R7$(2),e.Y8G("matMenuTriggerFor",F)("matMenuTriggerData",e.lJ4(36,G)),e.R7$(2),e.Y8G("matMenuTriggerFor",Y)("matMenuTriggerData",e.lJ4(37,G)),e.R7$(2),e.Y8G("matMenuTriggerFor",U)("matMenuTriggerData",e.lJ4(38,G)),e.R7$(8),e.Y8G("ngForOf",a.productsItems),e.R7$(7),e.Y8G("ngForOf",a.placesItems),e.R7$(7),e.Y8G("ngForOf",a.category),e.R7$(6),e.Y8G("ngForOf",a.statusItems),e.R7$(6),e.Y8G("ngForOf",a.priorityItems),e.R7$(2),e.Y8G("rangePicker",x)("formGroup",a.range),e.R7$(3),e.Y8G("for",x),e.R7$(3),e.Y8G("ngIf",a.isLoading),e.R7$(2),e.Y8G("ngIf",!a.isLoading),e.R7$(),e.Y8G("ngIf",a.isNotFound&&!a.isLoading),e.R7$(),e.Y8G("pageSize",10)("pageSizeOptions",e.lJ4(39,ne))("showFirstLastButtons",!0)}},dependencies:[k.MD,k.YU,k.Sq,k.bT,m.Ou,m.iy,v.hM,D.tP,D.Zl,D.tL,D.ji,D.cC,D.YV,D.iL,D.KS,D.$R,D.YZ,D.NB,f.X1,f.me,f.BC,f.cb,f.j4,f.JD,I.fS,I.fg,y.rl,y.yw,V.NQ,V.B4,T.An,d.Cn,d.kk,d.fb,d.Cp,N.g7,N.So,f.YN,f.vS,y.RG,E.X6,E.bU,E.el,E.xR,E.IG,E.SG,_.Ve,_.VO,S.wT,S.Sy,M.Hl,M.$z,Z.Wk],styles:[".mat-mdc-form-field-subscript-wrapper{display:none!important}",".mat-mdc-form-field-subscript-wrapper[_ngcontent-%COMP%] {\n        display: none;\n    }"]})}}return i})()},35883:(z,L,n)=>{n.d(L,{M:()=>y});var C=n(10467),k=n(54438),e=n(84412),f=n(86648),N=n(88141),S=n(3366),E=n(45794),v=n(64394);let y=(()=>{class T{constructor(d,m,_){this._apiService=d,this._toastService=m,this._analyticsService=_,this._data=new e.t(null),this._datas=(0,k.vPA)([]),this.sumarry=(0,k.vPA)(null),this.isLoading=(0,k.vPA)(!0),this.isNotFound=(0,k.vPA)(!1)}get data$(){return this._data.asObservable()}get currentProducts$(){return this._analyticsService.currentProducts()}Update(d){this._data.next(d)}checkTickets(){return(0,f.H)(this._apiService.get("api/V1/check-tickets-deadline")).pipe((0,N.M)(d=>{console.log(d)}))}fetchDataByDate(d,m){this.isLoading.set(!0),this._apiService.get(`api/V1/tickets-date?start_date=${d}&end_date=${m}`).then(_=>{this.isLoading.set(!1),this.isNotFound.set(!1),this._datas.set(_.data),null!==_.data&&0!=_.data.length||this.isNotFound.set(!0)}).catch(_=>{this.isLoading.set(!1),this.isNotFound.set(!0),this._toastService.error("Failed to fetch data","Error")})}fetchData(){var d=this;return(0,C.A)(function*(){d.isLoading.set(!0),d._apiService.get("api/V1/tickets").then(m=>{d.isLoading.set(!1),d.isNotFound.set(!1),d._datas.set(m.data),null!==m.data&&0!=m.data.length||d.isNotFound.set(!0)}).catch(m=>{d.isLoading.set(!1),d.isNotFound.set(!0),d._toastService.error("Failed to fetch data","Error")})})()}fetchDataByPlaces(d){var m=this;return(0,C.A)(function*(){m.isLoading.set(!0),m._apiService.post("api/V1/statistik/places",{places_name:d}).then(_=>{m.isLoading.set(!1),m.isNotFound.set(!1),m.sumarry.set(_.data.data.sumary),m._datas.set(_.data.data.tickets),null!==_.data&&0!=_.data.length||m.isNotFound.set(!0)}).catch(_=>{m.isLoading.set(!1),m.isNotFound.set(!0),m._toastService.error("Failed to fetch data","Error")})})()}fetchDataByCategory(d){var m=this;return(0,C.A)(function*(){m.isLoading.set(!0),m._apiService.post("api/V1/statistik/category",{category_name:d}).then(_=>{m.isLoading.set(!1),m.isNotFound.set(!1),m.sumarry.set(_.data.data.sumary),m._datas.set(_.data.data.tickets),null!==_.data&&0!=_.data.length||m.isNotFound.set(!0)}).catch(_=>{m.isLoading.set(!1),m.isNotFound.set(!0),m._toastService.error("Failed to fetch data","Error")})})()}fetchDataByUsers(d){var m=this;return(0,C.A)(function*(){m.isLoading.set(!0),m._apiService.post("api/V1/statistik/user",{name:d,product_name:m.currentProducts$}).then(_=>{m.isLoading.set(!1),m.isNotFound.set(!1),m.sumarry.set(_.data.data.sumary),m._datas.set(_.data.data.tickets),null!==_.data&&0!=_.data.length||m.isNotFound.set(!0)}).catch(_=>{m.isLoading.set(!1),m.isNotFound.set(!0),m._toastService.error("Failed to fetch data","Error")})})()}static{this.\u0275fac=function(m){return new(m||T)(k.KVO(S.G),k.KVO(E.tw),k.KVO(v.c))}}static{this.\u0275prov=k.jDH({token:T,factory:T.\u0275fac,providedIn:"root"})}}return T})()}}]);