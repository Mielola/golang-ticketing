"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[1526],{21526:(at,_,o)=>{o.r(_),o.d(_,{default:()=>q});var d=o(10467),u=o(60177),r=o(89417),w=o(88834),h=o(86600),p=o(25084),f=o(53719),g=o(99213),b=o(59042),F=o(82798),y=o(76233),m=(o(44549),o(9159)),k=o(96695),T=o(2042),t=o(54438),v=o(74710),S=o(3366),j=o(45794),R=o(46601);const C=(i,s,e,l)=>({"text-green-600":i,"text-blue-600":s,"text-yellow-600":e,"text-red-600":l}),E=i=>["/dashboards/tickets",i],$=(i,s,e)=>({"bg-blue-500":i,"bg-yellow-500":s,"bg-green-500":e});function I(i,s){if(1&i&&(t.j41(0,"mat-option",46),t.EFF(1),t.k0s()),2&i){const e=s.$implicit;t.Y8G("value",e),t.R7$(),t.SpI(" ",e," ")}}function x(i,s){if(1&i&&(t.j41(0,"mat-option",46),t.EFF(1),t.k0s()),2&i){const e=s.$implicit;t.Y8G("value",e.id),t.R7$(),t.SpI(" ",e.category_name," ")}}function G(i,s){if(1&i&&(t.j41(0,"mat-option",46),t.nrm(1,"mat-icon",47),t.EFF(2),t.k0s()),2&i){const e=s.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ngClass",t.ziG(3,C,"low"===e.toLowerCase(),"medium"===e.toLowerCase(),"high"===e.toLowerCase(),"critical"===e.toLowerCase())),t.R7$(),t.SpI(" ",e," ")}}function N(i,s){if(1&i&&(t.j41(0,"mat-option",46),t.EFF(1),t.k0s()),2&i){const e=s.$implicit;t.Y8G("value",e),t.R7$(),t.SpI(" ",e," ")}}function Y(i,s){1&i&&(t.j41(0,"mat-header-cell"),t.EFF(1," Tracking ID "),t.k0s())}function P(i,s){if(1&i&&(t.j41(0,"mat-cell",64)(1,"a",65),t.EFF(2),t.k0s()()),2&i){const e=s.$implicit;t.R7$(),t.Y8G("routerLink",t.eq3(2,E,e.tickets_id)),t.R7$(),t.JRh(e.tickets_id)}}function V(i,s){1&i&&(t.j41(0,"mat-header-cell"),t.EFF(1," User "),t.k0s())}function L(i,s){1&i&&(t.j41(0,"div",66),t.nrm(1,"div",67),t.k0s())}function A(i,s){if(1&i&&(t.j41(0,"mat-cell",68)(1,"div",69),t.nrm(2,"img",70),t.j41(3,"p",71),t.EFF(4),t.k0s()()()),2&i){const e=s.$implicit;t.R7$(2),t.Y8G("src",e.user.avatar,t.B4B),t.R7$(2),t.JRh(e.user.name)}}function B(i,s){1&i&&(t.j41(0,"mat-header-cell"),t.EFF(1," New Status "),t.k0s())}function U(i,s){if(1&i&&(t.j41(0,"mat-cell")(1,"div",72)(2,"h1",71),t.EFF(3),t.k0s()()()),2&i){const e=s.$implicit;t.R7$(),t.Y8G("ngClass",t.sMw(2,$,"New"===e.new_status,"On Progress"===e.new_status,"Resolved"===e.new_status)),t.R7$(2),t.JRh(e.new_status)}}function X(i,s){1&i&&(t.j41(0,"mat-header-cell"),t.EFF(1," Priority "),t.k0s())}function O(i,s){if(1&i&&(t.j41(0,"mat-cell",73),t.nrm(1,"mat-icon",47),t.j41(2,"h1",74),t.EFF(3),t.k0s()()),2&i){const e=s.$implicit;t.R7$(),t.Y8G("ngClass",t.ziG(2,C,"Low"===e.priority,"Medium"===e.priority,"High"===e.priority,"Critical"===e.priority)),t.R7$(2),t.JRh(e.priority)}}function J(i,s){1&i&&(t.j41(0,"mat-header-cell"),t.EFF(1," Details "),t.k0s())}function M(i,s){if(1&i&&(t.j41(0,"mat-cell",75),t.EFF(1),t.k0s()),2&i){const e=s.$implicit;t.R7$(),t.SpI(" ",e.details," ")}}function H(i,s){1&i&&(t.j41(0,"mat-header-cell"),t.EFF(1," Update at "),t.k0s())}function z(i,s){if(1&i&&(t.j41(0,"mat-cell",73),t.EFF(1),t.k0s()),2&i){const e=s.$implicit;t.R7$(),t.SpI(" ",e.update_at," ")}}function W(i,s){1&i&&t.nrm(0,"mat-header-row")}function Z(i,s){1&i&&t.nrm(0,"mat-row")}function Q(i,s){if(1&i&&(t.j41(0,"mat-table",48,2)(2,"div"),t.qex(3,49),t.DNE(4,Y,2,0,"mat-header-cell",50)(5,P,3,4,"mat-cell",51),t.bVm(),t.qex(6,52),t.DNE(7,V,2,0,"mat-header-cell",50)(8,L,2,0,"div",53)(9,A,5,2,"mat-cell",54),t.bVm(),t.qex(10,55),t.DNE(11,B,2,0,"mat-header-cell",50)(12,U,4,6,"mat-cell",56),t.bVm(),t.qex(13,57),t.DNE(14,X,2,0,"mat-header-cell",50)(15,O,4,7,"mat-cell",58),t.bVm(),t.qex(16,59),t.DNE(17,J,2,0,"mat-header-cell",50)(18,M,2,1,"mat-cell",60),t.bVm(),t.qex(19,61),t.DNE(20,H,2,0,"mat-header-cell",50)(21,z,2,1,"mat-cell",58),t.bVm(),t.DNE(22,W,1,0,"mat-header-row",62)(23,Z,1,0,"mat-row",63),t.k0s()()),2&i){const e=t.XpG();t.Y8G("dataSource",e.dataSource),t.R7$(8),t.Y8G("ngIf",e.isLoading),t.R7$(14),t.Y8G("matHeaderRowDef",e.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",e.displayedColumns)}}function K(i,s){if(1&i){const e=t.RV6();t.j41(0,"button",44),t.bIt("click",function(){t.eBV(e);const a=t.XpG();return t.Njj(a.handleDeleteTicket())}),t.EFF(1," Delete Ticket "),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("disabled",e.shiftStatus&&!e.isAdmin)("ngClass",e.shiftStatus&&!e.isAdmin?"bg-gray-400":"bg-red-500 hover:bg-red-600")}}const q=[{path:"",component:(()=>{class i{constructor(e,l,a,n,c,tt,et){this.route=e,this.router=l,this._apiService=a,this.fb=n,this.cdr=c,this._toastService=tt,this.fuseConfirmationService=et,this.products=[],this.category=[],this.disableInput=!0,this.priority=["Low","Medium","High","Critical"],this.status=["New","On Progress","Resolved"],this.isLoading=!1,this.shiftStatus=!1,this.isAdmin="admin"===localStorage.getItem("userRole"),this.displayedColumns=["tracking_id","user","new_status","priority","details","update_at"],this.dataSource=new m.I6}ngOnInit(){var e=this;this.fetchUsers(),this.TicketForm=this.fb.group({products_name:["",r.k0.required],category_id:[{value:0,disabled:this.disableInput},r.k0.required],no_whatsapp:[{value:"",disabled:this.disableInput},r.k0.required],detail_kendala:[{value:"",disabled:this.disableInput},r.k0.required],priority:[{value:"",disabled:this.disableInput},r.k0.required],status:[{value:"",disabled:this.disableInput},r.k0.required],hari_masuk:[{value:null,disabled:this.disableInput},r.k0.required],waktu_masuk:[{value:"",disabled:this.disableInput},r.k0.required],respon_diberikan:[{value:"",disabled:this.disableInput},r.k0.required],PIC:[{value:"",disabled:this.disableInput}]}),this.fetchDataProducts(),this.route.paramMap.subscribe(l=>{const a=l.get("trackingId");a&&(this.tracking_id=a),this.fetchData(a)}),this.TicketForm.get("products_name")?.valueChanges.subscribe(function(){var l=(0,d.A)(function*(a){if(a){const{data:n}=yield e._apiService.post("api/V1/get-data-form",{name:a});e.category=n.data,console.log(e.category),e.enableFields()}else e.disableFields()});return function(a){return l.apply(this,arguments)}}())}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}enableFields(){Object.keys(this.TicketForm.controls).forEach(e=>{"products_name"!==e&&this.TicketForm.get(e)?.enable()})}disableFields(){Object.keys(this.TicketForm.controls).forEach(e=>{"products_name"!==e&&this.TicketForm.get(e)?.disable()})}onSubmit(){var e=this;return(0,d.A)(function*(){try{200===(yield e._apiService.post(`api/V1/tickets/${e.tracking_id}`,e.TicketForm.value)).status&&e.fetchData(e.tracking_id)}catch(l){throw l}})()}handleDeleteTicket(){this.fuseConfirmationService.open({title:"Delete Confirmation",message:`Are you sure want to delete this ticket ${this.tracking_id}?`,actions:{confirm:{label:"Delete"}}}).afterClosed().subscribe(l=>{"confirmed"===l&&this.deleteProducts(this.tracking_id)})}deleteProducts(e){var l=this;return(0,d.A)(function*(){try{const{status:n}=yield l._apiService.delete(`api/V1/tickets/${e}`);return 200===n?(l._toastService.success("Success Delete Products","Success"),void l.router.navigate(["/dashboards/tickets"])):void l._toastService.error("Failed Delete Products","Failed")}catch(a){throw l._toastService.error("Failed Delete Products","Failed"),a}})()}fetchDataProducts(){var e=this;return(0,d.A)(function*(){try{const l=yield e._apiService.get("api/V1/list-products");e.products=l.data}catch(l){console.error("Error fetching data:",l)}})()}fetchData(e){var l=this;return(0,d.A)(function*(){const a=yield l._apiService.get(`api/V1/tickets/${e}`);l.dataSource.data=a.data.history,l.data=a.data,l.TicketForm.patchValue({products_name:a.data.products_name,category_id:a.data.category_id,no_whatsapp:a.data.no_whatsapp,detail_kendala:a.data.detail_kendala,priority:a.data.priority,status:a.data.status,hari_masuk:new Date(a.data.hari_masuk),waktu_masuk:a.data.waktu_masuk,respon_diberikan:a.data.respon_admin,PIC:a.data.pic})})()}fetchUsers(){var e=this;return(0,d.A)(function*(){try{e.isLoading=!0;const l=yield e._apiService.get("api/V1/get-profile");e.shiftStatus="Active Shift"!==l.data.shift_status,e.cdr.detectChanges()}catch(l){throw l}finally{e.isLoading=!1}})()}static{this.\u0275fac=function(l){return new(l||i)(t.rXU(v.nX),t.rXU(v.Ix),t.rXU(S.G),t.rXU(r.ok),t.rXU(t.gRc),t.rXU(j.tw),t.rXU(R.G))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-detail-tickets"]],viewQuery:function(l,a){if(1&l&&(t.GBs(T.B4,5),t.GBs(k.iy,5)),2&l){let n;t.mGM(n=t.lsd())&&(a.sort=n.first),t.mGM(n=t.lsd())&&(a.paginator=n.first)}},standalone:!0,features:[t.aNF],decls:96,vars:25,consts:[["picker",""],["paginator",""],["table",""],[1,"h-full","w-full","flex","flex-col","sm:flex-row","items-center","justify-center","gap-3","p-5","sm:px-10","lg:px-20"],[1,"h-fit","bg-white","shadow-xl","self-start","p-5","w-full","mx-2","sm:mx-0","sm:w-1/2","border-[0.4px]","border-opacity-20","border-black","rounded-md"],[1,"flex","flex-col"],[1,"text-3xl","font-semibold"],[1,"opacity-80","text-base"],[1,"mt-5","w-full",3,"formGroup"],["action","",1,"mt-2.5","flex","flex-col","gap-5"],["hideRequiredMarker","",1,"w-full"],["formControlName","products_name","placeholder","Select Products"],["class","px-3 py-1 m-2 font-medium text-base rounded-full",3,"value",4,"ngFor","ngForOf"],[1,"w-full"],["formControlName","category_id"],["formControlName","no_whatsapp","matInput","",3,"placeholder"],["formControlName","PIC","matInput","",3,"placeholder"],["floatLabel","always",1,"w-full","mb-2"],["formControlName","detail_kendala","matInput","","rows","4","cols","50","placeholder","Problem Detail"],[1,"grid","grid-cols-2","h-fit","gap-2"],["formControlName","priority","placeholder","Select Priority"],["formControlName","status"],[1,"example-full-width"],["formControlName","hari_masuk","matInput","","placeholder","Choose a date",3,"matDatepicker"],["matSuffix","",3,"for"],["touchUi",""],["formControlName","waktu_masuk","matInput","","type","time"],[1,"flex","flex-col","mb-4"],[1,"flex","flex-col","xl:flex-row","gap-2"],[1,"h-fit","bg-sky-500","p-5","xl:w-1/2","w-full","rounded-lg"],[1,"font-semibold","text-white","text-lg","mb-3"],[1,"flex","items-center","justify-around","rounded"],["alt","avatar.png",1,"bg-white","h-12","w-12","md:h-14","md:w-14","rounded-full",3,"src"],[1,"text-white","font-medium"],[1,"h-fit","bg-green-500","p-5","xl:w-1/2","w-full","rounded-lg"],[1,"my-4","w-full",3,"formGroup"],["floatLabel","always",1,"w-full"],["formControlName","respon_diberikan","matInput","","rows","4","cols","50","placeholder","Response Admin"],[1,"h-fit","w-full","shadow-xl","border-[0.4px]","border-opacity-20","border-black","rounded-lg","my-4","p-4"],[1,"text-lg","font-semibold"],[1,"w-full","overflow-auto","whitespace-nowrap","mt-5"],["matSort","","class","min-w-256",3,"dataSource",4,"ngIf"],[3,"pageSize","showFirstLastButtons"],[1,"flex","flex-col","gap-4"],[1,"w-full","rounded-full","p-3","text-white","font-semibold",3,"click","disabled","ngClass"],["class"," w-full rounded-full p-3 text-white font-semibold ",3,"disabled","ngClass","click",4,"ngIf"],[1,"px-3","py-1","m-2","font-medium","text-base","rounded-full",3,"value"],["svgIcon","mat_outline:bookmark",1,"-rotate-90",3,"ngClass"],["matSort","",1,"min-w-256",3,"dataSource"],["matColumnDef","tracking_id"],[4,"matHeaderCellDef"],["class","text-lg text-blue-600 font-medium underline whitespace-nowrap",4,"matCellDef"],["matColumnDef","user"],["role","status","class","p-5 animate-pulse",4,"ngIf"],["class","py-3.5 flex items-center gap-3 w-fit",4,"matCellDef"],["matColumnDef","new_status"],[4,"matCellDef"],["matColumnDef","priority"],["class","flex items-center gap-3",4,"matCellDef"],["matColumnDef","details"],["class","flex items-center gap-3 py-5",4,"matCellDef"],["matColumnDef","update_at"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"text-lg","text-blue-600","font-medium","underline","whitespace-nowrap"],[3,"routerLink"],["role","status",1,"p-5","animate-pulse"],[1,"h-6","bg-gray-300","rounded-full","dark:bg-gray-700","w-full","mb-[22px]"],[1,"py-3.5","flex","items-center","gap-3","w-fit"],[1,"w-full","flex","items-center","gap-3"],["alt","",1,"w-7","h-7","object-cover","rounded-full",3,"src"],[1,"font-medium"],[1,"px-3","py-1","text-white","whitespace-nowrap","rounded-full",3,"ngClass"],[1,"flex","items-center","gap-3"],[1,"font-medium","uppercase"],[1,"flex","items-center","gap-3","py-5"]],template:function(l,a){if(1&l){const n=t.RV6();t.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"h1",6),t.EFF(4),t.k0s(),t.j41(5,"p",7),t.EFF(6),t.k0s()(),t.j41(7,"form",8)(8,"div",9)(9,"mat-form-field",10)(10,"mat-label"),t.EFF(11,"Products"),t.k0s(),t.j41(12,"mat-select",11),t.DNE(13,I,2,2,"mat-option",12),t.k0s()(),t.j41(14,"mat-form-field",13)(15,"mat-label"),t.EFF(16,"Category"),t.k0s(),t.j41(17,"mat-select",14),t.DNE(18,x,2,2,"mat-option",12),t.k0s()(),t.j41(19,"mat-form-field",13)(20,"mat-label"),t.EFF(21,"No Whatsapp"),t.k0s(),t.nrm(22,"input",15),t.k0s(),t.j41(23,"mat-form-field",13)(24,"mat-label"),t.EFF(25,"PIC"),t.k0s(),t.nrm(26,"input",16),t.k0s(),t.j41(27,"mat-form-field",17)(28,"mat-label"),t.EFF(29,"Problem Detail"),t.k0s(),t.nrm(30,"textarea",18),t.k0s(),t.j41(31,"div",19)(32,"mat-form-field",10)(33,"mat-label"),t.EFF(34,"Priority"),t.k0s(),t.j41(35,"mat-select",20),t.DNE(36,G,3,8,"mat-option",12),t.k0s()(),t.j41(37,"mat-form-field",13)(38,"mat-label"),t.EFF(39,"Status"),t.k0s(),t.j41(40,"mat-select",21),t.DNE(41,N,2,2,"mat-option",12),t.k0s()(),t.j41(42,"mat-form-field",22)(43,"mat-label"),t.EFF(44,"Entry day"),t.k0s(),t.nrm(45,"input",23)(46,"mat-datepicker-toggle",24)(47,"mat-datepicker",25,0),t.k0s(),t.j41(49,"mat-form-field",22)(50,"mat-label"),t.EFF(51,"Entry Time"),t.k0s(),t.nrm(52,"input",26),t.k0s()()()()(),t.j41(53,"div",4)(54,"div",27)(55,"h1",6),t.EFF(56,"Admin Information"),t.k0s(),t.j41(57,"p",7),t.EFF(58),t.k0s()(),t.j41(59,"div",28)(60,"div",29)(61,"h1",30),t.EFF(62,"Created Ticket :"),t.k0s(),t.j41(63,"div",31),t.nrm(64,"img",32),t.j41(65,"div",33)(66,"h1"),t.EFF(67),t.k0s(),t.j41(68,"h1"),t.EFF(69),t.k0s()()()(),t.j41(70,"div",34)(71,"h1",30),t.EFF(72,"Last Replier :"),t.k0s(),t.j41(73,"div",31),t.nrm(74,"img",32),t.j41(75,"div",33)(76,"h1"),t.EFF(77),t.k0s(),t.j41(78,"h1"),t.EFF(79),t.k0s()()()()(),t.j41(80,"form",35)(81,"mat-form-field",36)(82,"mat-label"),t.EFF(83,"Response Admin"),t.k0s(),t.nrm(84,"textarea",37),t.k0s()(),t.j41(85,"div",38)(86,"h1",39),t.EFF(87,"History Tickets"),t.k0s(),t.j41(88,"div",40),t.DNE(89,Q,24,4,"mat-table",41),t.k0s(),t.nrm(90,"mat-paginator",42,1),t.k0s(),t.j41(92,"div",43)(93,"button",44),t.bIt("click",function(){return t.eBV(n),t.Njj(a.onSubmit())}),t.EFF(94," Save Ticket "),t.k0s(),t.DNE(95,K,2,2,"button",45),t.k0s()()()}if(2&l){const n=t.sdS(48);t.R7$(4),t.JRh(null==a.data?null:a.data.tracking_id),t.R7$(2),t.SpI("Subject : ",null==a.data?null:a.data.subject,""),t.R7$(),t.Y8G("formGroup",a.TicketForm),t.R7$(6),t.Y8G("ngForOf",a.products),t.R7$(5),t.Y8G("ngForOf",a.category),t.R7$(4),t.Y8G("placeholder","No Whatsapp"),t.R7$(4),t.Y8G("placeholder","PIC"),t.R7$(10),t.Y8G("ngForOf",a.priority),t.R7$(5),t.Y8G("ngForOf",a.status),t.R7$(4),t.Y8G("matDatepicker",n),t.R7$(),t.Y8G("for",n),t.R7$(12),t.SpI("Subject : ",null==a.data?null:a.data.subject,""),t.R7$(6),t.FS9("src",null==a.data?null:a.data.user.avatar,t.B4B),t.R7$(3),t.SpI("Email : ",null==a.data?null:a.data.user.email,""),t.R7$(2),t.SpI("Nama : ",null==a.data?null:a.data.user.name,""),t.R7$(5),t.FS9("src",null==a.data||null==a.data.last_replier?null:a.data.last_replier.avatar,t.B4B),t.R7$(3),t.SpI("Email : ",null==a.data||null==a.data.last_replier?null:a.data.last_replier.email,""),t.R7$(2),t.SpI("Nama : ",null==a.data||null==a.data.last_replier?null:a.data.last_replier.name,""),t.R7$(),t.Y8G("formGroup",a.TicketForm),t.R7$(9),t.Y8G("ngIf",!a.isNotDataFound&&!a.isLoading&&0!=a.dataSource.data.length),t.R7$(),t.Y8G("pageSize",3)("showFirstLastButtons",!0),t.R7$(3),t.Y8G("disabled",a.shiftStatus&&!a.isAdmin||"Resolved"===(null==a.data?null:a.data.status))("ngClass",a.shiftStatus&&!a.isAdmin||"Resolved"===a.data.status?"bg-gray-400":"bg-blue-500 hover:bg-blue-600"),t.R7$(2),t.Y8G("ngIf",a.isAdmin)}},dependencies:[f.RG,f.rl,f.nJ,f.yw,r.X1,r.qT,r.me,r.BC,r.cb,r.j4,r.JD,F.Ve,F.VO,h.wT,h.Sy,w.Hl,b.fS,b.fg,p.X6,p.Vh,p.bZ,p.bU,y.aP,u.MD,u.YU,u.Sq,u.bT,g.m_,g.An,h.WX,m.tP,m.Zl,m.tL,m.ji,m.cC,m.YV,m.iL,m.KS,m.$R,m.YZ,m.NB,k.Ou,k.iy,r.YN],styles:[".mat-mdc-form-field-subscript-wrapper{display:none!important}"]})}}return i})()}]}}]);