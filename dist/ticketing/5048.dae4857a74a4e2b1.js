"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[5048],{65048:(A,j,l)=>{l.r(j),l.d(j,{default:()=>Je});var f=l(74710),D=l(68589),C=l(10467),b=l(60177),e=l(54438),m=l(89417),w=l(82765),g=l(86600),F=l(25084),d=l(75351),h=l(53719),x=l(99213),R=l(59042),E=l(59115),I=l(96695),M=l(82798),$=l(2042),p=l(9159),O=l(21413),N=l(88834),U=l(40171),X=l(5271),V=l(62288),G=l(3366),W=l(45794),B=l(35883),J=l(46601);let H=(()=>{class a{constructor(t,o,i,s,c,u){this._apiService=t,this.toast=o,this._ticketTableSerivce=i,this.fuseConfirmationService=s,this.dialogRef=c,this.data=u,this.isLoading=!1,this.excelData=[],this.selectedFile=null}ngOnInit(){}onFileChange(t){const o=t.target.files[0];if(o){this.selectedFile=o;const i=new FileReader;i.onload=s=>{const c=new Uint8Array(s.target.result),u=V.LF(c,{type:"array"});this.excelData=V.Wp.sheet_to_json(u.Sheets[u.SheetNames[0]])},i.readAsArrayBuffer(o)}}onSubmit(){var t=this;return(0,C.A)(function*(){if(t.selectedFile)if(t.excelData&&0!==t.excelData.length)try{t.isLoading=!0,console.log(t.excelData);const{status:i}=yield t._apiService.post("api/V1/tickets/excel",t.excelData);if(201===i)return t.toast.success("Success Create Tickets","Success"),t._ticketTableSerivce.fetchData(),t.dialogRef.close(),void(t.isLoading=!1);if(500===i)return t.toast.error("Internal Server Error","Failed"),t.dialogRef.close(),void(t.isLoading=!1);if(409===i)t.isLoading=!1,t.fuseConfirmationService.open({title:"Notification",message:"The Tickets already exists on the server. Would you like to create another Tickets time anyway?",icon:{color:"info"},actions:{confirm:{label:"Confirmation",color:"primary"}}});else if(400===i)return t.toast.error("Bad Request","Failed"),t.dialogRef.close(),void(t.isLoading=!1)}catch(o){throw o}else t.toast.warning("The selected file is empty or invalid.","Warning");else t.toast.warning("Please select a file before submitting.","Warning")})()}static{this.\u0275fac=function(o){return new(o||a)(e.rXU(G.G),e.rXU(W.tw),e.rXU(B.M),e.rXU(J.G),e.rXU(d.CP),e.rXU(d.Vh))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-import-excel"]],standalone:!0,features:[e.aNF],decls:26,vars:2,consts:[[1,"h-full","w-full","flex","flex-col"],[1,"flex","justify-between","p-2"],[1,"truncate","text-lg","font-medium","leading-6","tracking-tight","px-5","py-3","flex","flex-col","items-start","w-full","justify-between"],[1,"mb-2","text-2xl","font-semibold","sm:mb-0"],[1,"text-sm","text-gray-500"],["href","files/template_ticket_import.xlsx","download","",1,"text-blue-600","underline"],[3,"click"],["svgIcon","mat_solid:close",1,"cursor-pointer"],["message","Sumbitting Form...","spinner","circular",3,"isOpen"],[1,""],[1,"bg-card","flex","flex-col","overflow-hidden","rounded-2xl","px-8","py-4","pb-4","gap-5"],[1,"flex","flex-col","gap-2"],["for","excelFile",1,"text-sm","font-medium","text-gray-700","mb-1"],[1,"flex","items-center","border","border-gray-300","rounded-lg","px-4","py-2","cursor-pointer","hover:border-blue-500"],["type","file","id","excelFile","accept",".xlsx, .xls",1,"hidden",3,"change"],["for","excelFile",1,"flex-1","text-gray-600","cursor-pointer"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-6","w-6","text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M12 12v6m0 0l3-3m-3 3l-3-3M16 8V4H8v4"],["type","submit",1,"bg-green-600","text-white","p-2","rounded",3,"click"]],template:function(o,i){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),e.EFF(4,"Import Excel"),e.k0s(),e.j41(5,"p",4),e.EFF(6," Upload an Excel file. "),e.j41(7,"a",5),e.EFF(8,"Download here"),e.k0s(),e.EFF(9,". "),e.k0s()(),e.j41(10,"a",6),e.bIt("click",function(){return i.dialogRef.close()}),e.nrm(11,"mat-icon",7),e.k0s()(),e.nrm(12,"ion-loading",8),e.j41(13,"div",9)(14,"form",10)(15,"div",11)(16,"label",12),e.EFF(17,"Upload Excel File"),e.k0s(),e.j41(18,"div",13)(19,"input",14),e.bIt("change",function(c){return i.onFileChange(c)}),e.k0s(),e.j41(20,"label",15),e.EFF(21),e.k0s(),e.qSk(),e.j41(22,"svg",16),e.nrm(23,"path",17),e.k0s()()(),e.joV(),e.j41(24,"button",18),e.bIt("click",function(){return i.onSubmit()}),e.EFF(25," Import Excel "),e.k0s()()()()),2&o&&(e.R7$(12),e.Y8G("isOpen",i.isLoading),e.R7$(9),e.SpI(" ",i.selectedFile?i.selectedFile.name:"Choose Excel file..."," "))},dependencies:[m.X1,m.qT,m.cb,m.YN,m.cV,h.RG,R.fS,N.Hl,x.m_,x.An,X.rQ,F.X6,g.Sy,M.Ve,b.MD]})}}return a})();var P=l(10801);const K=()=>["/dashboards/tickets/add-tickets"],S=()=>({disableClose:!0}),z=()=>[5,10,20],Q=(a,n,t)=>({"bg-blue-500":a,"bg-yellow-500":n,"bg-green-500":t}),Y=(a,n,t,o)=>({"text-green-600":a,"text-blue-600":n,"text-yellow-600":t,"text-red-600":o}),Z=a=>["/dashboards/tickets",a];function q(a,n){if(1&a){const t=e.RV6();e.j41(0,"mat-checkbox",54),e.mxI("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.DH7(s.checked,i)||(s.checked=i),e.Njj(i)}),e.bIt("click",function(i){return e.eBV(t),e.Njj(i.stopPropagation())})("change",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.applyProductsFilter())}),e.EFF(1),e.k0s()}if(2&a){const t=n.$implicit;e.R50("ngModel",t.checked),e.R7$(),e.SpI(" ",t.name," ")}}function ee(a,n){if(1&a){const t=e.RV6();e.j41(0,"mat-checkbox",55),e.mxI("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.DH7(s.checked,i)||(s.checked=i),e.Njj(i)}),e.bIt("click",function(i){return e.eBV(t),e.Njj(i.stopPropagation())})("change",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.applyCategoryFilter())}),e.EFF(1),e.k0s()}if(2&a){const t=n.$implicit;e.R50("ngModel",t.checked),e.R7$(),e.JRh(t.name)}}function te(a,n){if(1&a){const t=e.RV6();e.j41(0,"mat-checkbox",54),e.mxI("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.DH7(s.checked,i)||(s.checked=i),e.Njj(i)}),e.bIt("click",function(i){return e.eBV(t),e.Njj(i.stopPropagation())})("change",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.applyStatusFilter())}),e.j41(1,"div",56)(2,"h1",57),e.EFF(3),e.k0s()()()}if(2&a){const t=n.$implicit;e.R50("ngModel",t.checked),e.R7$(),e.Y8G("ngClass",e.sMw(3,Q,"New"===t.name,"On Progress"===t.name,"Resolved"===t.name)),e.R7$(2),e.JRh(t.name)}}function ae(a,n){if(1&a){const t=e.RV6();e.j41(0,"mat-checkbox",54),e.mxI("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.DH7(s.checked,i)||(s.checked=i),e.Njj(i)}),e.bIt("click",function(i){return e.eBV(t),e.Njj(i.stopPropagation())})("change",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.applyPriorityFilter())}),e.j41(1,"div",18),e.nrm(2,"mat-icon",58),e.j41(3,"h1",59),e.EFF(4),e.k0s()()()}if(2&a){const t=n.$implicit;e.R50("ngModel",t.checked),e.R7$(2),e.Y8G("ngClass",e.ziG(3,Y,"Low"===t.name,"Hedium"===t.name,"High"===t.name,"Critical"===t.name)),e.R7$(2),e.JRh(t.name)}}function ie(a,n){1&a&&(e.j41(0,"div",60),e.nrm(1,"div",61)(2,"div",61)(3,"div",61)(4,"div",61)(5,"div",61)(6,"div",61)(7,"div",62),e.k0s())}function ne(a,n){1&a&&(e.j41(0,"div",63)(1,"div",64),e.nrm(2,"img",65)(3,"br"),e.j41(4,"p",66),e.EFF(5,"Data Not Found"),e.k0s(),e.j41(6,"p",67),e.EFF(7,"try using a different keyword or add a new tickets"),e.k0s()()())}function oe(a,n){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Tracking ID "),e.k0s())}function le(a,n){if(1&a&&(e.j41(0,"mat-cell",94)(1,"a",95),e.EFF(2),e.k0s()()),2&a){const t=n.$implicit;e.R7$(),e.Y8G("routerLink",e.eq3(2,Z,t.tracking_id)),e.R7$(),e.JRh(t.tracking_id)}}function se(a,n){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Ticket Entry Day "),e.k0s())}function re(a,n){if(1&a&&(e.j41(0,"mat-cell",18),e.nrm(1,"mat-icon",96),e.EFF(2),e.k0s()),2&a){const t=n.$implicit;e.R7$(2),e.SpI(" ",t.hari_masuk," ")}}function ce(a,n){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Ticket Entry Time "),e.k0s())}function me(a,n){if(1&a&&(e.j41(0,"mat-cell",18),e.nrm(1,"mat-icon",97),e.EFF(2),e.k0s()),2&a){const t=n.$implicit;e.R7$(2),e.SpI(" ",t.waktu_masuk," ")}}function de(a,n){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Category "),e.k0s())}function ue(a,n){if(1&a&&(e.j41(0,"mat-cell",98),e.EFF(1),e.k0s()),2&a){const t=n.$implicit;e.R7$(),e.SpI(" ",t.category," ")}}function pe(a,n){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Users "),e.k0s())}function fe(a,n){1&a&&(e.j41(0,"div",60),e.nrm(1,"div",61),e.k0s())}function he(a,n){if(1&a&&(e.j41(0,"mat-cell",99)(1,"div",100),e.nrm(2,"img",101),e.j41(3,"p",57),e.EFF(4),e.k0s()()()),2&a){const t=n.$implicit;e.R7$(2),e.Y8G("src",t.user.avatar,e.B4B),e.R7$(2),e.JRh(t.user.name)}}function _e(a,n){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," PIC "),e.k0s())}function ge(a,n){if(1&a&&(e.j41(0,"mat-cell"),e.EFF(1),e.k0s()),2&a){const t=n.$implicit;e.R7$(),e.SpI(" ",""==(null==t?null:t.pic)||null==(null==t?null:t.pic)?"Not Found":t.pic," ")}}function ke(a,n){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Subject "),e.k0s())}function xe(a,n){if(1&a&&(e.j41(0,"mat-cell",102),e.EFF(1),e.k0s()),2&a){const t=n.$implicit;e.R7$(),e.SpI(" ",t.subject," ")}}function be(a,n){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Whatsapp Client "),e.k0s())}function Fe(a,n){if(1&a&&(e.j41(0,"mat-cell")(1,"a",103),e.EFF(2),e.k0s()()),2&a){const t=n.$implicit;e.R7$(),e.Y8G("href","https://wa.me/"+(null==t?null:t.no_whatsapp),e.B4B),e.R7$(),e.SpI(" ",""===(null==t?null:t.no_whatsapp)?"Not Found":t.no_whatsapp," ")}}function ye(a,n){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Status "),e.k0s())}function Ce(a,n){if(1&a){const t=e.RV6();e.j41(0,"mat-option",108),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG().$implicit,c=e.XpG(2);return e.Njj(c.changeStatus(s.tracking_id,i))}),e.EFF(1),e.k0s()}if(2&a){const t=n.$implicit;e.Y8G("value",t),e.R7$(),e.SpI(" ",t," ")}}function ve(a,n){if(1&a){const t=e.RV6();e.j41(0,"mat-cell",104)(1,"mat-form-field",105)(2,"mat-select",106),e.mxI("valueChange",function(i){const s=e.eBV(t).$implicit;return e.DH7(s.status,i)||(s.status=i),e.Njj(i)}),e.DNE(3,Ce,2,2,"mat-option",107),e.k0s()()()}if(2&a){const t=n.$implicit,o=e.XpG(2);e.R7$(2),e.R50("value",t.status),e.Y8G("disabled","Resolved"===t.status||o.shiftStatus&&!o.isAdmin),e.R7$(),e.Y8G("ngForOf",o.statusList)}}function Te(a,n){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Solved Time "),e.k0s())}function je(a,n){if(1&a&&(e.j41(0,"mat-cell"),e.EFF(1),e.k0s()),2&a){const t=n.$implicit;e.R7$(),e.SpI(" ",""===t.solved_time||null===t.solved_time?"On Progress":t.solved_time,"")}}function we(a,n){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Last Replier "),e.k0s())}function Ee(a,n){1&a&&(e.j41(0,"div",60),e.nrm(1,"div",61),e.k0s())}function Se(a,n){if(1&a&&(e.j41(0,"mat-cell",109)(1,"div",100),e.nrm(2,"img",110),e.j41(3,"p",57),e.EFF(4),e.k0s()()()),2&a){const t=n.$implicit;e.R7$(2),e.Y8G("src",null===t.last_replier?t.user.avatar:t.last_replier.avatar,e.B4B),e.R7$(2),e.JRh(null===t.last_replier?t.user.name:t.last_replier.name)}}function De(a,n){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Priority "),e.k0s())}function Re(a,n){if(1&a&&(e.j41(0,"mat-cell",18),e.nrm(1,"mat-icon",58),e.j41(2,"h1",59),e.EFF(3),e.k0s()()),2&a){const t=n.$implicit;e.R7$(),e.Y8G("ngClass",e.ziG(2,Y,"Low"===t.priority,"Medium"===t.priority,"High"===t.priority,"Critical"===t.priority)),e.R7$(2),e.JRh(t.priority)}}function Ie(a,n){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Created Date "),e.k0s())}function Me(a,n){if(1&a&&(e.j41(0,"mat-cell",18),e.nrm(1,"mat-icon",96),e.EFF(2),e.k0s()),2&a){const t=n.$implicit;e.R7$(2),e.SpI(" ",t.created_date," ")}}function $e(a,n){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Created Time "),e.k0s())}function Ne(a,n){if(1&a&&(e.j41(0,"mat-cell",18),e.nrm(1,"mat-icon",97),e.EFF(2),e.k0s()),2&a){const t=n.$implicit;e.R7$(2),e.SpI(" ",t.created_time," ")}}function Le(a,n){1&a&&e.nrm(0,"mat-header-row")}function Ve(a,n){1&a&&e.nrm(0,"mat-row")}function Ge(a,n){if(1&a&&(e.j41(0,"mat-table",68,8)(2,"div"),e.qex(3,69),e.DNE(4,oe,2,0,"mat-header-cell",70)(5,le,3,4,"mat-cell",71),e.bVm(),e.qex(6,72),e.DNE(7,se,2,0,"mat-header-cell",70)(8,re,3,1,"mat-cell",73),e.bVm(),e.qex(9,74),e.DNE(10,ce,2,0,"mat-header-cell",70)(11,me,3,1,"mat-cell",73),e.bVm(),e.qex(12,75),e.DNE(13,de,2,0,"mat-header-cell",70)(14,ue,2,1,"mat-cell",76),e.bVm(),e.qex(15,77),e.DNE(16,pe,2,0,"mat-header-cell",70)(17,fe,2,0,"div",49)(18,he,5,2,"mat-cell",78),e.bVm(),e.qex(19,79),e.DNE(20,_e,2,0,"mat-header-cell",70)(21,ge,2,1,"mat-cell",80),e.bVm(),e.qex(22,81),e.DNE(23,ke,2,0,"mat-header-cell",70)(24,xe,2,1,"mat-cell",82),e.bVm(),e.qex(25,83),e.DNE(26,be,2,0,"mat-header-cell",70)(27,Fe,3,2,"mat-cell",80),e.bVm(),e.qex(28,84),e.DNE(29,ye,2,0,"mat-header-cell",70)(30,ve,4,3,"mat-cell",85),e.bVm(),e.qex(31,86),e.DNE(32,Te,2,0,"mat-header-cell",70)(33,je,2,1,"mat-cell",80),e.bVm(),e.qex(34,87),e.DNE(35,we,2,0,"mat-header-cell",70)(36,Ee,2,0,"div",49)(37,Se,5,2,"mat-cell",88),e.bVm(),e.qex(38,89),e.DNE(39,De,2,0,"mat-header-cell",70)(40,Re,4,7,"mat-cell",73),e.bVm(),e.qex(41,90),e.DNE(42,Ie,2,0,"mat-header-cell",70)(43,Me,3,1,"mat-cell",73),e.bVm(),e.qex(44,91),e.DNE(45,$e,2,0,"mat-header-cell",70)(46,Ne,3,1,"mat-cell",73),e.bVm(),e.DNE(47,Le,1,0,"mat-header-row",92)(48,Ve,1,0,"mat-row",93),e.k0s()()),2&a){const t=e.XpG();e.Y8G("dataSource",t.dataSource),e.R7$(17),e.Y8G("ngIf",t.isLoading),e.R7$(19),e.Y8G("ngIf",t.isLoading),e.R7$(11),e.Y8G("matHeaderRowDef",t.displayedColumns),e.R7$(),e.Y8G("matRowDefColumns",t.displayedColumns)}}const L=new Date,Be=L.getMonth(),Pe=L.getFullYear();L.getDay();let Ye=(()=>{class a{constructor(t,o,i,s,c){this._apiService=t,this.cdr=o,this._ticketLogsService=i,this._ticketTableService=s,this._matDialog=c,this.filterValues={search:"",category:[],products:[],status:[],priority:[]},this.shiftStatus=!0,this.ticketStatus=!1,this.isAdmin="admin"===localStorage.getItem("userRole"),this.statusList=["New","On Progress","Resolved"],this.productsItems=[],this.category=[],this.statusItems=[],this.priorityItems=[],this._unsubscribeAll=new O.B,this.displayedColumns=["tracking_id","hari_masuk","waktu_masuk","name","category","subject","pic","no_whatsapp","status","solved_time","last_replier","priority","create_date","create_time"],this.dataSource=new p.I6,this.range=new m.gE({start:new m.MJ(new Date(Pe,Be-1)),end:new m.MJ(new Date)}),(0,e.QZP)(()=>{const u=this.datas,k=new Set,_=new Set,v=new Set,T=new Set;u.forEach(r=>{r.products_name&&(Array.isArray(r.products_name)?r.products_name.forEach(y=>T.add(y)):T.add(r.products_name)),r.category&&(Array.isArray(r.category)?r.category.forEach(y=>k.add(y)):(k.add(r.category),_.add(r.status))),r.status&&(Array.isArray(r.status)?r.status.forEach(y=>_.add(y)):_.add(r.status)),r.priority&&(Array.isArray(r.priority)?r.priority.forEach(y=>v.add(y)):v.add(r.priority)),r.subject||(r.subject="Subject Not Found")}),this.statusItems=[..._].map(r=>({name:r,checked:!1})),this.category=[...k].map(r=>({name:r,checked:!1})),this.priorityItems=[...v].map(r=>({name:r,checked:!1})),this.productsItems=[...T].map(r=>({name:r,checked:!1})),this.dataSource.data=u})}get datas(){return this._ticketTableService._datas()}get isLoading(){return this._ticketTableService.isLoading()}get isNotFound(){return this._ticketTableService.isNotFound()}ngOnInit(){this.fetchUsers(),this.range.valueChanges.subscribe(({start:t,end:o})=>{if(o){const i=t instanceof Date?t:new Date(t),s=o instanceof Date?o:new Date(o);this._ticketTableService.fetchDataByDate(i.toLocaleDateString("en-CA"),s.toLocaleDateString("en-CA"))}})}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}importExcel(){this._matDialog.open(H,{width:window.innerWidth<600?"90%":"50%",maxWidth:"100vw"})}generateReport(){this._matDialog.open(U.E,{width:window.innerWidth<600?"90%":"50%",maxWidth:"100vw"})}fetchUsers(){var t=this;return(0,C.A)(function*(){try{const o=yield t._apiService.get("api/V1/get-profile");t.shiftStatus="Active Shift"!==o.data.shift_status,t.cdr.detectChanges()}catch(o){throw o}})()}applyFilter(){this.dataSource.filterPredicate=(t,o)=>{let i=JSON.parse(o),s=""===i.search||t.tracking_id.toLowerCase().includes(i.search)||t.created_date.toLowerCase().includes(i.search)||t.created_time.toLowerCase().includes(i.search)||t.hari_masuk.toLowerCase().includes(i.search)||t.waktu_masuk.toLowerCase().includes(i.search)||t.products_name.toLowerCase().includes(i.search)||t.category.toLowerCase().includes(i.search)||t.subject.toLowerCase().includes(i.search)||t.status.toLowerCase().includes(i.search)||t.priority.toLowerCase().includes(i.search)||t.no_whatsapp.toLowerCase().includes(i.search)||t.user?.name.toLowerCase().includes(i.search)||t.last_replier?.name.toLowerCase().includes(i.search),c=0===i.category.length||i.category.includes(t.category.toLowerCase()),u=0===i.status.length||i.status.includes(t.status.toLowerCase()),k=0===i.priority.length||i.priority.includes(t.priority.toLowerCase()),_=0===i.products.length||i.products.includes(t.products_name.toLowerCase());return s&&c&&u&&k&&_},this.dataSource.filter=JSON.stringify(this.filterValues)}applySearchFilter(t){this.filterValues.search=t.trim().toLowerCase(),this.applyFilter()}applyProductsFilter(){this.filterValues.products=this.productsItems.filter(t=>t.checked).map(t=>t.name.toLowerCase()),this.applyFilter()}applyCategoryFilter(){this.filterValues.category=this.category.filter(t=>t.checked).map(t=>t.name.toLowerCase()),this.applyFilter()}applyStatusFilter(){this.filterValues.status=this.statusItems.filter(t=>t.checked).map(t=>t.name.toLowerCase()),this.applyFilter()}applyPriorityFilter(){this.filterValues.priority=this.priorityItems.filter(t=>t.checked).map(t=>t.name.toLowerCase()),this.applyFilter()}changeStatus(t,o){var i=this;return(0,C.A)(function*(){try{const{status:s}=yield i._apiService.post(`api/V1/ticket-status/${t}`,{status:o});if(200===s){const u=yield i._apiService.get("api/V1/tickets-logs");i._ticketLogsService.Update(u),i._ticketTableService.fetchData()}}catch(s){throw s}})()}static{this.\u0275fac=function(o){return new(o||a)(e.rXU(G.G),e.rXU(e.gRc),e.rXU(P.j),e.rXU(B.M),e.rXU(d.bZ))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-ticket"]],viewQuery:function(o,i){if(1&o&&(e.GBs($.B4,5),e.GBs(I.iy,5)),2&o){let s;e.mGM(s=e.lsd())&&(i.sort=s.first),e.mGM(s=e.lsd())&&(i.paginator=s.first)}},standalone:!0,features:[e.aNF],decls:91,vars:35,consts:[["addUserMenu","matMenu"],["picker",""],["menu","matMenu"],["products","matMenu"],["categorys","matMenu"],["status","matMenu"],["priority","matMenu"],["paginator",""],["table",""],[1,"h-fit","border-[1px]","shadow-xl","mt-4","bg-white","rounded-lg","p-5"],[1,"flex","flex-col","items-start","lg:flex-row","sm:items-center","justify-between"],[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","gap-3","w-1/3","max-lg:w-full"],["for","table-search",1,"sr-only"],[1,"relative","my-2","w-full"],[1,"absolute","inset-y-0","rtl:inset-r-0","start-0","flex","items-center","ps-3","pointer-events-none"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 20 20",1,"w-4","h-4","text-gray-500","dark:text-gray-400"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"],["type","text","matInput","","placeholder","Search Tickets",1,"block","w-full","p-4","ps-10","text-sm","text-gray-900","border","border-gray-300","rounded-lg","bg-gray-50","focus:ring-blue-500","focus:border-blue-500","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500",3,"keyup"],[1,"flex","items-center","gap-3"],["mat-raised-button","",1,"flex","w-fit","text-nowrap","items-center","gap-2","p-2.5","rounded-full","px-3","sm:px-5","text-white",3,"disabled","matMenuTriggerFor","ngClass"],[1,"flex","items-center","gap-1"],[1,"m-2","pr-4","border-r-[1px]"],["svgIcon","keyboard_arrow_down",1,"font-bold","text-2xl"],["mat-menu-item","",3,"routerLink"],["svgIcon","mat_outline:add",1,"icon-size-5"],["mat-menu-item","",3,"click"],["svgIcon","mat_outline:upload_file",1,"icon-size-5"],["mat-raised-button","",1,"flex","w-fit","text-nowrap","items-center","gap-2","p-2.5","rounded-full","px-3","sm:px-5","bg-red-500","text-white",3,"click"],["svgIcon","mat_solid:picture_as_pdf",1,"text-white"],[1,"max-sm:hidden","font-semibold"],[1,"min-w-[300px]","max-w-full","self-end","hidden","sm:block"],[1,"w-full",3,"rangePicker","formGroup"],["matStartDate","","formControlName","start","placeholder","Start date",1,"w-full"],["matEndDate","","formControlName","end","placeholder","End date",1,"w-full"],["matSuffix","",3,"for"],["touchUi",""],[1,"flex","items-center","gap-2","p-2.5","rounded-full","px-3","sm:px-5","border-[1px]","text-white",3,"matMenuTriggerFor"],["svgIcon","filter_alt"],[1,"max-sm:hidden","font-semibold","text-black"],["svgIcon","keyboard_arrow_down"],["mat-menu-item","",3,"matMenuTriggerFor","matMenuTriggerData"],[1,"min-w-[300px]"],[1,"px-5","py-3","w-full"],[1,"font-semibold","mb-2"],[1,"px-5","flex","flex-col","gap-2","w-full"],["class","h-full",3,"ngModel","ngModelChange","click","change",4,"ngFor","ngForOf"],["class","h-full w-full",3,"ngModel","ngModelChange","click","change",4,"ngFor","ngForOf"],[1,"px-5","py-3"],[1,"min-w-[300px]","max-w-full","pt-4","self-start","sm:hidden","block"],["role","status","class","p-5 animate-pulse",4,"ngIf"],["class","py-10",4,"ngIf"],[1,"w-full","overflow-auto","whitespace-nowrap","mt-5"],["matSort","","class","min-w-[2480px]",3,"dataSource",4,"ngIf"],[3,"pageSize","pageSizeOptions","showFirstLastButtons"],[1,"h-full",3,"ngModelChange","click","change","ngModel"],[1,"h-full","w-full",3,"ngModelChange","click","change","ngModel"],[1,"px-3","py-1","text-white","whitespace-nowrap","rounded-full",3,"ngClass"],[1,"font-medium"],["svgIcon","mat_outline:bookmark",1,"-rotate-90",3,"ngClass"],[1,"font-medium","uppercase"],["role","status",1,"p-5","animate-pulse"],[1,"h-6","bg-gray-300","rounded-full","dark:bg-gray-700","w-full","mb-[22px]"],[1,"h-6","bg-gray-300","rounded-full","dark:bg-gray-700","w-full"],[1,"py-10"],[1,"flex","flex-col","items-center"],["src","icons/not-found.jpg","alt","not-found.jpg",1,"h-64","bg-cover","bg-center","object-scale-down"],[1,"text-lg","font-semibold"],[1,"text-sm"],["matSort","",1,"min-w-[2480px]",3,"dataSource"],["matColumnDef","tracking_id"],[4,"matHeaderCellDef"],["class","text-lg text-blue-600 font-medium underline whitespace-nowrap",4,"matCellDef"],["matColumnDef","hari_masuk"],["class","flex items-center gap-3",4,"matCellDef"],["matColumnDef","waktu_masuk"],["matColumnDef","category"],["class","flex items-center gap-3 font-medium",4,"matCellDef"],["matColumnDef","name"],["class","py-3.5 flex items-center gap-3 w-fit",4,"matCellDef"],["matColumnDef","pic"],[4,"matCellDef"],["matColumnDef","subject"],["class","font-bold text-lg",4,"matCellDef"],["matColumnDef","no_whatsapp"],["matColumnDef","status"],["class","py-4 w-full",4,"matCellDef"],["matColumnDef","solved_time"],["matColumnDef","last_replier"],["class","py-2 flex items-center gap-3 w-fit",4,"matCellDef"],["matColumnDef","priority"],["matColumnDef","create_date"],["matColumnDef","create_time"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"text-lg","text-blue-600","font-medium","underline","whitespace-nowrap"],[3,"routerLink"],["svgIcon","mat_solid:date_range"],["svgIcon","mat_outline:access_time"],[1,"flex","items-center","gap-3","font-medium"],[1,"py-3.5","flex","items-center","gap-3","w-fit"],[1,"w-full","flex","items-center","gap-3"],["alt","",1,"w-7","h-7","object-cover","rounded-full",3,"src"],[1,"font-bold","text-lg"],["target","_blank",3,"href"],[1,"py-4","w-full"],["hideRequiredMarker","",1,"w-full"],["placeholder","Select",3,"valueChange","value","disabled"],["class","px-3 py-1 m-2 font-medium text-base rounded-full",3,"value","click",4,"ngFor","ngForOf"],[1,"px-3","py-1","m-2","font-medium","text-base","rounded-full",3,"click","value"],[1,"py-2","flex","items-center","gap-3","w-fit"],["alt","",1,"w-7","h-7","rounded-full",3,"src"]],template:function(o,i){if(1&o){const s=e.RV6();e.j41(0,"section",9)(1,"div",10)(2,"div",11)(3,"label",12),e.EFF(4,"Search"),e.k0s(),e.j41(5,"div",13)(6,"div",14),e.qSk(),e.j41(7,"svg",15),e.nrm(8,"path",16),e.k0s()(),e.joV(),e.j41(9,"input",17),e.bIt("keyup",function(u){return e.eBV(s),e.Njj(i.applySearchFilter(u.target.value))}),e.k0s()()(),e.j41(10,"div",18)(11,"button",19)(12,"div",20)(13,"span",21),e.EFF(14,"New Tickets"),e.k0s(),e.nrm(15,"mat-icon",22),e.k0s()(),e.j41(16,"mat-menu",null,0)(18,"button",23),e.nrm(19,"mat-icon",24),e.j41(20,"span"),e.EFF(21,"Add Tickets"),e.k0s()(),e.j41(22,"button",25),e.bIt("click",function(){return e.eBV(s),e.Njj(i.importExcel())}),e.nrm(23,"mat-icon",26),e.j41(24,"span"),e.EFF(25,"Import Excel"),e.k0s()()(),e.j41(26,"button",27),e.bIt("click",function(){return e.eBV(s),e.Njj(i.generateReport())}),e.nrm(27,"mat-icon",28),e.j41(28,"span",29),e.EFF(29,"Generate Report"),e.k0s()(),e.j41(30,"mat-form-field",30)(31,"mat-date-range-input",31),e.nrm(32,"input",32)(33,"input",33),e.k0s(),e.nrm(34,"mat-datepicker-toggle",34)(35,"mat-date-range-picker",35,1),e.k0s(),e.j41(37,"button",36),e.nrm(38,"mat-icon",37),e.j41(39,"span",38),e.EFF(40,"Filter"),e.k0s(),e.nrm(41,"mat-icon",39),e.k0s(),e.j41(42,"mat-menu",null,2)(44,"button",40),e.EFF(45,"Products"),e.k0s(),e.j41(46,"button",40),e.EFF(47,"Category"),e.k0s(),e.j41(48,"button",40),e.EFF(49,"Status"),e.k0s(),e.j41(50,"button",40),e.EFF(51,"Priority"),e.k0s(),e.j41(52,"mat-menu",41,3)(54,"div",42)(55,"h1",43),e.EFF(56,"Choose Products"),e.k0s()(),e.j41(57,"div",44),e.DNE(58,q,2,2,"mat-checkbox",45),e.k0s()(),e.j41(59,"mat-menu",41,4)(61,"div",42)(62,"h1",43),e.EFF(63,"Choose Category"),e.k0s()(),e.j41(64,"div",44),e.DNE(65,ee,2,2,"mat-checkbox",46),e.k0s()(),e.j41(66,"mat-menu",null,5)(68,"div",47)(69,"h1",43),e.EFF(70,"Choose status"),e.k0s()(),e.DNE(71,te,4,7,"mat-checkbox",45),e.k0s(),e.j41(72,"mat-menu",null,6)(74,"div",47)(75,"h1",43),e.EFF(76,"Choose Priority"),e.k0s()(),e.DNE(77,ae,5,8,"mat-checkbox",45),e.k0s()()(),e.j41(78,"mat-form-field",48)(79,"mat-date-range-input",31),e.nrm(80,"input",32)(81,"input",33),e.k0s(),e.nrm(82,"mat-datepicker-toggle",34)(83,"mat-date-range-picker",null,1),e.k0s()(),e.DNE(85,ie,8,0,"div",49)(86,ne,8,0,"div",50),e.j41(87,"div",51),e.DNE(88,Ge,49,5,"mat-table",52),e.k0s(),e.nrm(89,"mat-paginator",53,7),e.k0s()}if(2&o){const s=e.sdS(17),c=e.sdS(36),u=e.sdS(43),k=e.sdS(53),_=e.sdS(60),v=e.sdS(67),T=e.sdS(73);e.R7$(11),e.Y8G("disabled",i.shiftStatus&&!i.isAdmin)("matMenuTriggerFor",s)("ngClass",i.shiftStatus&&!i.isAdmin?"bg-gray-400":"bg-primary"),e.R7$(7),e.Y8G("routerLink",e.lJ4(29,K)),e.R7$(13),e.Y8G("rangePicker",c)("formGroup",i.range),e.R7$(3),e.Y8G("for",c),e.R7$(3),e.Y8G("matMenuTriggerFor",u),e.R7$(7),e.Y8G("matMenuTriggerFor",k)("matMenuTriggerData",e.lJ4(30,S)),e.R7$(2),e.Y8G("matMenuTriggerFor",_)("matMenuTriggerData",e.lJ4(31,S)),e.R7$(2),e.Y8G("matMenuTriggerFor",v)("matMenuTriggerData",e.lJ4(32,S)),e.R7$(2),e.Y8G("matMenuTriggerFor",T)("matMenuTriggerData",e.lJ4(33,S)),e.R7$(8),e.Y8G("ngForOf",i.productsItems),e.R7$(7),e.Y8G("ngForOf",i.category),e.R7$(6),e.Y8G("ngForOf",i.statusItems),e.R7$(6),e.Y8G("ngForOf",i.priorityItems),e.R7$(2),e.Y8G("rangePicker",c)("formGroup",i.range),e.R7$(3),e.Y8G("for",c),e.R7$(3),e.Y8G("ngIf",i.isLoading),e.R7$(),e.Y8G("ngIf",i.isNotFound&&!i.isLoading),e.R7$(2),e.Y8G("ngIf",!i.isNotFound&&!i.isLoading&&0!=i.dataSource.data.length),e.R7$(),e.Y8G("pageSize",10)("pageSizeOptions",e.lJ4(34,z))("showFirstLastButtons",!0)}},dependencies:[b.MD,b.YU,b.Sq,b.bT,I.Ou,I.iy,d.hM,p.tP,p.Zl,p.tL,p.ji,p.cC,p.YV,p.iL,p.KS,p.$R,p.YZ,p.NB,m.X1,m.me,m.BC,m.cb,m.j4,m.JD,R.fS,R.fg,h.rl,h.yw,$.NQ,$.B4,x.An,E.Cn,E.kk,E.fb,E.Cp,w.g7,w.So,m.YN,m.vS,h.RG,F.X6,F.bU,F.el,F.xR,F.IG,F.SG,M.Ve,M.VO,g.wT,g.Sy,N.Hl,N.$z,f.Wk],styles:[".mat-mdc-form-field-subscript-wrapper{display:none!important}",".mat-mdc-form-field-subscript-wrapper[_ngcontent-%COMP%] {\n        display: none;\n    }"]})}}return a})();const Ae=()=>["/dashboards/home"];let Oe=(()=>{class a{static{this.\u0275fac=function(o){return new(o||a)}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-tickets"]],standalone:!0,features:[e.aNF],decls:17,vars:2,consts:[[1,"p-4","h-full","w-full","sm:px-5"],[1,"px-1","pt-3","flex","justify-between","items-start","sm:items-center","flex-col","sm:flex-row","gap-5","sm:gap-0"],[1,"font-bold","text-lg","sm:text-3xl"],[1,"text-sm","sm:text-base"],[1,"text-sm","text-gray-600"],[1,"font-medium","text-gray-500","hover:cursor-pointer","hover:text-blue-400",3,"routerLink"],[1,"mx-2","text-gray-400"],[1,"font-semibold","text-blue-600","hover:text-blue-500"],[1,"h-fit","w-full"]],template:function(o,i){1&o&&(e.j41(0,"main",0)(1,"div",1)(2,"div")(3,"h1",2),e.EFF(4,"Tickets"),e.k0s(),e.j41(5,"p",3),e.EFF(6,"Keep track of ongoing tickets and follow up efficiently."),e.k0s()(),e.j41(7,"div",4)(8,"span",5),e.EFF(9,"Home"),e.k0s(),e.j41(10,"span",6),e.EFF(11,"/"),e.k0s(),e.j41(12,"span",7),e.EFF(13,"Tickets"),e.k0s()()(),e.j41(14,"div",8),e.nrm(15,"app-ticket")(16,"app-ticket-logs"),e.k0s()()),2&o&&(e.R7$(8),e.Y8G("routerLink",e.lJ4(1,Ae)))},dependencies:[Ye,D.V,f.Wk],encapsulation:2,changeDetection:0})}}return a})();var Ue=l(25798),Xe=l(96697),We=l(96354);const Je=[{path:"",component:Oe,resolve:{data:()=>(0,e.WQX)(P.j).fetchData()}},{path:"add-tickets",canActivate:[(a,n)=>{const t=(0,e.WQX)(f.Ix),o=(0,e.WQX)(Ue.D),i="admin"===localStorage.getItem("userRole");return o.user$.pipe((0,Xe.s)(1),(0,We.T)(s=>!(!i&&"Active Shift"!==s.shift_status)||t.parseUrl("/dashboards/tickets")))}],loadChildren:()=>Promise.all([l.e(6233),l.e(2076),l.e(789)]).then(l.bind(l,10789))},{path:":trackingId",loadChildren:()=>Promise.all([l.e(6233),l.e(1526)]).then(l.bind(l,21526))}]},35883:(A,j,l)=>{l.d(j,{M:()=>w});var f=l(54438),D=l(84412),C=l(86648),b=l(88141),e=l(3366),m=l(45794);let w=(()=>{class g{constructor(d,h){this._apiService=d,this._toastService=h,this._data=new D.t(null),this._datas=(0,f.vPA)([]),this.isLoading=(0,f.vPA)(!0),this.isNotFound=(0,f.vPA)(!1),this.checkTickets(),this.fetchData()}get data$(){return this._data.asObservable()}Update(d){this._data.next(d)}checkTickets(){return(0,C.H)(this._apiService.get("api/V1/check-tickets-deadline")).pipe((0,b.M)(d=>{}))}fetchDataByDate(d,h){this.isLoading.set(!0),this._apiService.get(`api/V1/tickets-date?start_date=${d}&end_date=${h}`).then(x=>{this.isLoading.set(!1),this.isNotFound.set(!1),this._datas.set(x.data),null!==x.data&&0!=x.data.length||this.isNotFound.set(!0)}).catch(x=>{this.isLoading.set(!1),this.isNotFound.set(!0),this._toastService.error("Failed to fetch data","Error")})}fetchData(){this.isLoading.set(!0),this._apiService.get("api/V1/tickets").then(d=>{this.isLoading.set(!1),this.isNotFound.set(!1),this._datas.set(d.data),null!==d.data&&0!=d.data.length||this.isNotFound.set(!0)}).catch(d=>{this.isLoading.set(!1),this.isNotFound.set(!0),this._toastService.error("Failed to fetch data","Error")})}static{this.\u0275fac=function(h){return new(h||g)(f.KVO(e.G),f.KVO(m.tw))}}static{this.\u0275prov=f.jDH({token:g,factory:g.\u0275fac,providedIn:"root"})}}return g})()}}]);