"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[5048],{65048:(Y,w,s)=>{s.r(w),s.d(w,{default:()=>Je});var y=s(74710),x=s(68589),T=s(10467),F=s(60177),e=s(54438),d=s(89417),S=s(82765),C=s(86600),f=s(25084),D=s(75351),c=s(53719),_=s(99213),b=s(59042),E=s(59115),I=s(96695),M=s(82798),$=s(2042),h=s(9159),O=s(21413),L=s(88834),U=s(40171),X=s(5271),V=s(62288),G=s(3366),W=s(45794),B=s(35883),P=s(10801),J=s(46601);let H=(()=>{class a{constructor(t,i,n,l,m,p,g){this._apiService=t,this.toast=i,this._ticketTableSerivce=n,this._ticketLogsTableService=l,this.fuseConfirmationService=m,this.dialogRef=p,this.data=g,this.isLoading=!1,this.excelData=[],this.selectedFile=null}ngOnInit(){}formatDate(t){const i=new Date(t.getTime()+6e4*t.getTimezoneOffset());return`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()+1).padStart(2,"0")}`}formatTime(t){return`${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`}onFileChange(t){const i=t.target.files[0];if(i){this.selectedFile=i;const n=new FileReader;n.onload=l=>{const m=new Uint8Array(l.target.result),p=V.LF(m,{type:"array",cellDates:!0});this.excelData=V.Wp.sheet_to_json(p.Sheets[p.SheetNames[0]]),this.excelData=this.excelData.map(u=>({...u,hari_masuk:u.hari_masuk instanceof Date?this.formatDate(u.hari_masuk):u.hari_masuk,hari_respon:u.hari_respon instanceof Date?this.formatDate(u.hari_respon):u.hari_respon,waktu_masuk:u.waktu_masuk instanceof Date?this.formatTime(u.waktu_masuk):u.waktu_masuk,waktu_respon:u.waktu_respon instanceof Date?this.formatTime(u.waktu_respon):u.waktu_respon})),console.log("Formatted Excel Data:",this.excelData)},n.readAsArrayBuffer(i)}}onSubmit(){var t=this;return(0,T.A)(function*(){if(t.selectedFile)if(t.excelData&&0!==t.excelData.length)try{t.isLoading=!0,console.log(t.excelData);const{status:n}=yield t._apiService.post("api/V1/tickets/excel",t.excelData);if(201===n)return t.toast.success("Success Create Tickets","Success"),t._ticketTableSerivce.fetchData(),t._ticketLogsTableService.fetchDatas(),t.dialogRef.close(),void(t.isLoading=!1);if(500===n)return t.toast.error("Internal Server Error","Failed"),t.dialogRef.close(),void(t.isLoading=!1);if(409===n)t.isLoading=!1,t.fuseConfirmationService.open({title:"Notification",message:"The Tickets already exists on the server. Would you like to create another Tickets time anyway?",icon:{color:"info"},actions:{confirm:{label:"Confirmation",color:"primary"}}});else if(400===n)return t.toast.error("Bad Request","Failed"),t.dialogRef.close(),void(t.isLoading=!1)}catch(i){throw i}else t.toast.warning("The selected file is empty or invalid.","Warning");else t.toast.warning("Please select a file before submitting.","Warning")})()}static{this.\u0275fac=function(i){return new(i||a)(e.rXU(G.G),e.rXU(W.tw),e.rXU(B.M),e.rXU(P.j),e.rXU(J.G),e.rXU(D.CP),e.rXU(D.Vh))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-import-excel"]],standalone:!0,features:[e.aNF],decls:26,vars:2,consts:[[1,"h-full","w-full","flex","flex-col"],[1,"flex","justify-between","p-2"],[1,"truncate","text-lg","font-medium","leading-6","tracking-tight","px-5","py-3","flex","flex-col","items-start","w-full","justify-between"],[1,"mb-2","text-2xl","font-semibold","sm:mb-0"],[1,"text-sm","text-gray-500"],["href","files/template_ticket_import.xlsx","download","",1,"text-blue-600","underline"],[3,"click"],["svgIcon","mat_solid:close",1,"cursor-pointer"],["message","Sumbitting Form...","spinner","circular",3,"isOpen"],[1,""],[1,"bg-card","flex","flex-col","overflow-hidden","rounded-2xl","px-8","py-4","pb-4","gap-5"],[1,"flex","flex-col","gap-2"],["for","excelFile",1,"text-sm","font-medium","text-gray-700","mb-1"],[1,"flex","items-center","border","border-gray-300","rounded-lg","px-4","py-2","cursor-pointer","hover:border-blue-500"],["type","file","id","excelFile","accept",".xlsx, .xls",1,"hidden",3,"change"],["for","excelFile",1,"flex-1","text-gray-600","cursor-pointer"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-6","w-6","text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M12 12v6m0 0l3-3m-3 3l-3-3M16 8V4H8v4"],["type","submit",1,"bg-green-600","text-white","p-2","rounded",3,"click"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),e.EFF(4,"Import Excel"),e.k0s(),e.j41(5,"p",4),e.EFF(6," Upload an Excel file. "),e.j41(7,"a",5),e.EFF(8,"Download here"),e.k0s(),e.EFF(9,". "),e.k0s()(),e.j41(10,"a",6),e.bIt("click",function(){return n.dialogRef.close()}),e.nrm(11,"mat-icon",7),e.k0s()(),e.nrm(12,"ion-loading",8),e.j41(13,"div",9)(14,"form",10)(15,"div",11)(16,"label",12),e.EFF(17,"Upload Excel File"),e.k0s(),e.j41(18,"div",13)(19,"input",14),e.bIt("change",function(m){return n.onFileChange(m)}),e.k0s(),e.j41(20,"label",15),e.EFF(21),e.k0s(),e.qSk(),e.j41(22,"svg",16),e.nrm(23,"path",17),e.k0s()()(),e.joV(),e.j41(24,"button",18),e.bIt("click",function(){return n.onSubmit()}),e.EFF(25," Import Excel "),e.k0s()()()()),2&i&&(e.R7$(12),e.Y8G("isOpen",n.isLoading),e.R7$(9),e.SpI(" ",n.selectedFile?n.selectedFile.name:"Choose Excel file..."," "))},dependencies:[d.X1,d.qT,d.cb,d.YN,d.cV,c.RG,b.fS,L.Hl,_.m_,_.An,X.rQ,f.X6,C.Sy,M.Ve,F.MD]})}}return a})();const K=()=>["/dashboards/tickets/add-tickets"],R=()=>({disableClose:!0}),z=()=>[5,10,20],Q=(a,o,t)=>({"bg-blue-500":a,"bg-yellow-500":o,"bg-green-500":t}),A=(a,o,t,i)=>({"text-green-600":a,"text-blue-600":o,"text-yellow-600":t,"text-red-600":i}),Z=a=>["/dashboards/tickets",a];function q(a,o){if(1&a){const t=e.RV6();e.j41(0,"mat-checkbox",54),e.mxI("ngModelChange",function(n){const l=e.eBV(t).$implicit;return e.DH7(l.checked,n)||(l.checked=n),e.Njj(n)}),e.bIt("click",function(n){return e.eBV(t),e.Njj(n.stopPropagation())})("change",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.applyProductsFilter())}),e.EFF(1),e.k0s()}if(2&a){const t=o.$implicit;e.R50("ngModel",t.checked),e.R7$(),e.SpI(" ",t.name," ")}}function ee(a,o){if(1&a){const t=e.RV6();e.j41(0,"mat-checkbox",55),e.mxI("ngModelChange",function(n){const l=e.eBV(t).$implicit;return e.DH7(l.checked,n)||(l.checked=n),e.Njj(n)}),e.bIt("click",function(n){return e.eBV(t),e.Njj(n.stopPropagation())})("change",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.applyCategoryFilter())}),e.EFF(1),e.k0s()}if(2&a){const t=o.$implicit;e.R50("ngModel",t.checked),e.R7$(),e.JRh(t.name)}}function te(a,o){if(1&a){const t=e.RV6();e.j41(0,"mat-checkbox",54),e.mxI("ngModelChange",function(n){const l=e.eBV(t).$implicit;return e.DH7(l.checked,n)||(l.checked=n),e.Njj(n)}),e.bIt("click",function(n){return e.eBV(t),e.Njj(n.stopPropagation())})("change",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.applyStatusFilter())}),e.j41(1,"div",56)(2,"h1",57),e.EFF(3),e.k0s()()()}if(2&a){const t=o.$implicit;e.R50("ngModel",t.checked),e.R7$(),e.Y8G("ngClass",e.sMw(3,Q,"New"===t.name,"On Progress"===t.name,"Resolved"===t.name)),e.R7$(2),e.JRh(t.name)}}function ae(a,o){if(1&a){const t=e.RV6();e.j41(0,"mat-checkbox",54),e.mxI("ngModelChange",function(n){const l=e.eBV(t).$implicit;return e.DH7(l.checked,n)||(l.checked=n),e.Njj(n)}),e.bIt("click",function(n){return e.eBV(t),e.Njj(n.stopPropagation())})("change",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.applyPriorityFilter())}),e.j41(1,"div",18),e.nrm(2,"mat-icon",58),e.j41(3,"h1",59),e.EFF(4),e.k0s()()()}if(2&a){const t=o.$implicit;e.R50("ngModel",t.checked),e.R7$(2),e.Y8G("ngClass",e.ziG(3,A,"Low"===t.name,"Hedium"===t.name,"High"===t.name,"Critical"===t.name)),e.R7$(2),e.JRh(t.name)}}function ne(a,o){1&a&&(e.j41(0,"div",60),e.nrm(1,"div",61)(2,"div",61)(3,"div",61)(4,"div",61)(5,"div",61)(6,"div",61)(7,"div",62),e.k0s())}function ie(a,o){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Tracking ID "),e.k0s())}function oe(a,o){if(1&a&&(e.j41(0,"mat-cell",89)(1,"a",90),e.EFF(2),e.k0s()()),2&a){const t=o.$implicit;e.R7$(),e.Y8G("routerLink",e.eq3(2,Z,t.tracking_id)),e.R7$(),e.JRh(t.tracking_id)}}function se(a,o){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Ticket Entry Day "),e.k0s())}function le(a,o){if(1&a&&(e.j41(0,"mat-cell",18),e.nrm(1,"mat-icon",91),e.EFF(2),e.k0s()),2&a){const t=o.$implicit;e.R7$(2),e.SpI(" ",t.hari_masuk," ")}}function re(a,o){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Ticket Entry Time "),e.k0s())}function ce(a,o){if(1&a&&(e.j41(0,"mat-cell",18),e.nrm(1,"mat-icon",92),e.EFF(2),e.k0s()),2&a){const t=o.$implicit;e.R7$(2),e.SpI(" ",t.waktu_masuk," ")}}function me(a,o){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Category "),e.k0s())}function ue(a,o){if(1&a&&(e.j41(0,"mat-cell",93),e.EFF(1),e.k0s()),2&a){const t=o.$implicit;e.R7$(),e.SpI(" ",t.category," ")}}function de(a,o){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Users "),e.k0s())}function pe(a,o){1&a&&(e.j41(0,"div",60),e.nrm(1,"div",61),e.k0s())}function _e(a,o){if(1&a&&(e.j41(0,"mat-cell",94)(1,"div",95),e.nrm(2,"img",96),e.j41(3,"p",57),e.EFF(4),e.k0s()()()),2&a){const t=o.$implicit;e.R7$(2),e.Y8G("src",t.user.avatar,e.B4B),e.R7$(2),e.JRh(t.user.name)}}function fe(a,o){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," PIC "),e.k0s())}function he(a,o){if(1&a&&(e.j41(0,"mat-cell"),e.EFF(1),e.k0s()),2&a){const t=o.$implicit;e.R7$(),e.SpI(" ",""==(null==t?null:t.pic)||null==(null==t?null:t.pic)?"Not Found":t.pic," ")}}function ge(a,o){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Subject "),e.k0s())}function ke(a,o){if(1&a&&(e.j41(0,"mat-cell",97),e.EFF(1),e.k0s()),2&a){const t=o.$implicit;e.R7$(),e.SpI(" ",t.subject," ")}}function xe(a,o){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Whatsapp Client "),e.k0s())}function be(a,o){if(1&a&&(e.j41(0,"mat-cell")(1,"a",98),e.EFF(2),e.k0s()()),2&a){const t=o.$implicit;e.R7$(),e.Y8G("href","https://wa.me/"+(null==t?null:t.no_whatsapp),e.B4B),e.R7$(),e.SpI(" ",""===(null==t?null:t.no_whatsapp)?"Not Found":t.no_whatsapp," ")}}function Fe(a,o){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Status "),e.k0s())}function ve(a,o){if(1&a){const t=e.RV6();e.j41(0,"mat-option",103),e.bIt("click",function(){const n=e.eBV(t).$implicit,l=e.XpG().$implicit,m=e.XpG(2);return e.Njj(m.changeStatus(l.tracking_id,n))}),e.EFF(1),e.k0s()}if(2&a){const t=o.$implicit;e.Y8G("value",t),e.R7$(),e.SpI(" ",t," ")}}function ye(a,o){if(1&a){const t=e.RV6();e.j41(0,"mat-cell",99)(1,"mat-form-field",100)(2,"mat-select",101),e.mxI("valueChange",function(n){const l=e.eBV(t).$implicit;return e.DH7(l.status,n)||(l.status=n),e.Njj(n)}),e.DNE(3,ve,2,2,"mat-option",102),e.k0s()()()}if(2&a){const t=o.$implicit,i=e.XpG(2);e.R7$(2),e.R50("value",t.status),e.Y8G("disabled",!i.isAdmin&&(i.shiftStatus||"Resolved"===(null==t?null:t.status))),e.R7$(),e.Y8G("ngForOf",i.statusList)}}function Te(a,o){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Solved Time "),e.k0s())}function Ce(a,o){if(1&a&&(e.j41(0,"mat-cell"),e.EFF(1),e.k0s()),2&a){const t=o.$implicit;e.R7$(),e.SpI(" ",""===t.solved_time||null===t.solved_time?"On Progress":t.solved_time,"")}}function je(a,o){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Last Replier "),e.k0s())}function we(a,o){1&a&&(e.j41(0,"div",60),e.nrm(1,"div",61),e.k0s())}function Se(a,o){if(1&a&&(e.j41(0,"mat-cell",104)(1,"div",95),e.nrm(2,"img",105),e.j41(3,"p",57),e.EFF(4),e.k0s()()()),2&a){const t=o.$implicit;e.R7$(2),e.Y8G("src",null===t.last_replier?t.user.avatar:t.last_replier.avatar,e.B4B),e.R7$(2),e.JRh(null===t.last_replier?t.user.name:t.last_replier.name)}}function De(a,o){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Priority "),e.k0s())}function Ee(a,o){if(1&a&&(e.j41(0,"mat-cell",18),e.nrm(1,"mat-icon",58),e.j41(2,"h1",59),e.EFF(3),e.k0s()()),2&a){const t=o.$implicit;e.R7$(),e.Y8G("ngClass",e.ziG(2,A,"Low"===t.priority,"Medium"===t.priority,"High"===t.priority,"Critical"===t.priority)),e.R7$(2),e.JRh(t.priority)}}function Re(a,o){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Created Date "),e.k0s())}function Ie(a,o){if(1&a&&(e.j41(0,"mat-cell",18),e.nrm(1,"mat-icon",91),e.EFF(2),e.k0s()),2&a){const t=o.$implicit;e.R7$(2),e.SpI(" ",t.created_date," ")}}function Me(a,o){1&a&&(e.j41(0,"mat-header-cell"),e.EFF(1," Created Time "),e.k0s())}function $e(a,o){if(1&a&&(e.j41(0,"mat-cell",18),e.nrm(1,"mat-icon",92),e.EFF(2),e.k0s()),2&a){const t=o.$implicit;e.R7$(2),e.SpI(" ",t.created_time," ")}}function Le(a,o){1&a&&e.nrm(0,"mat-header-row")}function Ne(a,o){1&a&&e.nrm(0,"mat-row")}function Ve(a,o){if(1&a&&(e.j41(0,"mat-table",63,8)(2,"div"),e.qex(3,64),e.DNE(4,ie,2,0,"mat-header-cell",65)(5,oe,3,4,"mat-cell",66),e.bVm(),e.qex(6,67),e.DNE(7,se,2,0,"mat-header-cell",65)(8,le,3,1,"mat-cell",68),e.bVm(),e.qex(9,69),e.DNE(10,re,2,0,"mat-header-cell",65)(11,ce,3,1,"mat-cell",68),e.bVm(),e.qex(12,70),e.DNE(13,me,2,0,"mat-header-cell",65)(14,ue,2,1,"mat-cell",71),e.bVm(),e.qex(15,72),e.DNE(16,de,2,0,"mat-header-cell",65)(17,pe,2,0,"div",49)(18,_e,5,2,"mat-cell",73),e.bVm(),e.qex(19,74),e.DNE(20,fe,2,0,"mat-header-cell",65)(21,he,2,1,"mat-cell",75),e.bVm(),e.qex(22,76),e.DNE(23,ge,2,0,"mat-header-cell",65)(24,ke,2,1,"mat-cell",77),e.bVm(),e.qex(25,78),e.DNE(26,xe,2,0,"mat-header-cell",65)(27,be,3,2,"mat-cell",75),e.bVm(),e.qex(28,79),e.DNE(29,Fe,2,0,"mat-header-cell",65)(30,ye,4,3,"mat-cell",80),e.bVm(),e.qex(31,81),e.DNE(32,Te,2,0,"mat-header-cell",65)(33,Ce,2,1,"mat-cell",75),e.bVm(),e.qex(34,82),e.DNE(35,je,2,0,"mat-header-cell",65)(36,we,2,0,"div",49)(37,Se,5,2,"mat-cell",83),e.bVm(),e.qex(38,84),e.DNE(39,De,2,0,"mat-header-cell",65)(40,Ee,4,7,"mat-cell",68),e.bVm(),e.qex(41,85),e.DNE(42,Re,2,0,"mat-header-cell",65)(43,Ie,3,1,"mat-cell",68),e.bVm(),e.qex(44,86),e.DNE(45,Me,2,0,"mat-header-cell",65)(46,$e,3,1,"mat-cell",68),e.bVm(),e.DNE(47,Le,1,0,"mat-header-row",87)(48,Ne,1,0,"mat-row",88),e.k0s()()),2&a){const t=e.XpG();e.Y8G("dataSource",t.dataSource),e.R7$(17),e.Y8G("ngIf",t.isLoading),e.R7$(19),e.Y8G("ngIf",t.isLoading),e.R7$(11),e.Y8G("matHeaderRowDef",t.displayedColumns),e.R7$(),e.Y8G("matRowDefColumns",t.displayedColumns)}}function Ge(a,o){1&a&&(e.j41(0,"div",106)(1,"div",107),e.nrm(2,"img",108)(3,"br"),e.j41(4,"p",109),e.EFF(5,"Data Not Found"),e.k0s(),e.j41(6,"p",110),e.EFF(7,"try using a different keyword or add a new tickets"),e.k0s()()())}const N=new Date,Be=N.getMonth(),Pe=N.getFullYear();N.getDay();let Ae=(()=>{class a{constructor(t,i,n,l,m){this._apiService=t,this.cdr=i,this._ticketLogsService=n,this._ticketTableService=l,this._matDialog=m,this.filterValues={search:"",category:[],products:[],status:[],priority:[]},this.shiftStatus=!0,this.ticketStatus=!1,this.isAdmin="admin"===localStorage.getItem("userRole"),this.statusList=["New","On Progress","Resolved"],this.productsItems=[],this.category=[],this.statusItems=[],this.priorityItems=[],this._unsubscribeAll=new O.B,this.displayedColumns=["tracking_id","hari_masuk","waktu_masuk","name","category","subject","pic","no_whatsapp","status","solved_time","last_replier","priority","create_date","create_time"],this.dataSource=new h.I6,this.range=new d.gE({start:new d.MJ(new Date(Pe,Be-1)),end:new d.MJ(new Date)}),this._ticketTableService.checkTickets(),this._ticketTableService.fetchData(),(0,e.QZP)(()=>{const p=this.datas,g=new Set,k=new Set,u=new Set,j=new Set;p.forEach(r=>{r.products_name&&(Array.isArray(r.products_name)?r.products_name.forEach(v=>j.add(v)):j.add(r.products_name)),r.category&&(Array.isArray(r.category)?r.category.forEach(v=>g.add(v)):(g.add(r.category),k.add(r.status))),r.status&&(Array.isArray(r.status)?r.status.forEach(v=>k.add(v)):k.add(r.status)),r.priority&&(Array.isArray(r.priority)?r.priority.forEach(v=>u.add(v)):u.add(r.priority)),r.subject||(r.subject="Subject Not Found")}),this.statusItems=[...k].map(r=>({name:r,checked:!1})),this.category=[...g].map(r=>({name:r,checked:!1})),this.priorityItems=[...u].map(r=>({name:r,checked:!1})),this.productsItems=[...j].map(r=>({name:r,checked:!1})),this.dataSource.data=0!==this._ticketTableService._datas().length?p:[]})}get datas(){return this._ticketTableService._datas()}get isLoading(){return this._ticketTableService.isLoading()}get isNotFound(){return this._ticketTableService.isNotFound()}ngOnInit(){this.fetchUsers(),this.range.valueChanges.subscribe(({start:t,end:i})=>{if(i){const n=t instanceof Date?t:new Date(t),l=i instanceof Date?i:new Date(i);this._ticketTableService.fetchDataByDate(n.toLocaleDateString("en-CA"),l.toLocaleDateString("en-CA"))}})}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}importExcel(){this._matDialog.open(H,{width:window.innerWidth<600?"90%":"50%",maxWidth:"100vw"})}generateReport(){this._matDialog.open(U.E,{width:window.innerWidth<600?"90%":"50%",maxWidth:"100vw"})}fetchUsers(){var t=this;return(0,T.A)(function*(){try{const i=yield t._apiService.get("api/V1/get-profile");t.shiftStatus="Active Shift"!==i.data.shift_status,t.cdr.detectChanges()}catch(i){throw i}})()}applyFilter(){this.dataSource.filterPredicate=(t,i)=>{let n=JSON.parse(i),l=""===n.search||t.tracking_id.toLowerCase().includes(n.search)||t.created_date.toLowerCase().includes(n.search)||t.created_time.toLowerCase().includes(n.search)||t.hari_masuk.toLowerCase().includes(n.search)||t.waktu_masuk.toLowerCase().includes(n.search)||t.products_name.toLowerCase().includes(n.search)||t.category.toLowerCase().includes(n.search)||t.subject.toLowerCase().includes(n.search)||t.status.toLowerCase().includes(n.search)||t.priority.toLowerCase().includes(n.search)||t.no_whatsapp.toLowerCase().includes(n.search)||t.user?.name.toLowerCase().includes(n.search)||t.last_replier?.name.toLowerCase().includes(n.search),m=0===n.category.length||n.category.includes(t.category.toLowerCase()),p=0===n.status.length||n.status.includes(t.status.toLowerCase()),g=0===n.priority.length||n.priority.includes(t.priority.toLowerCase()),k=0===n.products.length||n.products.includes(t.products_name.toLowerCase());return l&&m&&p&&g&&k},this.dataSource.filter=JSON.stringify(this.filterValues)}applySearchFilter(t){this.filterValues.search=t.trim().toLowerCase(),this.applyFilter()}applyProductsFilter(){this.filterValues.products=this.productsItems.filter(t=>t.checked).map(t=>t.name.toLowerCase()),this.applyFilter()}applyCategoryFilter(){this.filterValues.category=this.category.filter(t=>t.checked).map(t=>t.name.toLowerCase()),this.applyFilter()}applyStatusFilter(){this.filterValues.status=this.statusItems.filter(t=>t.checked).map(t=>t.name.toLowerCase()),this.applyFilter()}applyPriorityFilter(){this.filterValues.priority=this.priorityItems.filter(t=>t.checked).map(t=>t.name.toLowerCase()),this.applyFilter()}changeStatus(t,i){var n=this;return(0,T.A)(function*(){try{const{status:l}=yield n._apiService.post(`api/V1/ticket-status/${t}`,{status:i});if(200===l){const p=yield n._apiService.get("api/V1/tickets-logs");n._ticketLogsService.Update(p),n._ticketTableService.fetchData()}}catch(l){throw l}})()}static{this.\u0275fac=function(i){return new(i||a)(e.rXU(G.G),e.rXU(e.gRc),e.rXU(P.j),e.rXU(B.M),e.rXU(D.bZ))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-ticket"]],viewQuery:function(i,n){if(1&i&&(e.GBs($.B4,5),e.GBs(I.iy,5)),2&i){let l;e.mGM(l=e.lsd())&&(n.sort=l.first),e.mGM(l=e.lsd())&&(n.paginator=l.first)}},standalone:!0,features:[e.aNF],decls:91,vars:35,consts:[["addUserMenu","matMenu"],["picker",""],["menu","matMenu"],["products","matMenu"],["categorys","matMenu"],["status","matMenu"],["priority","matMenu"],["paginator",""],["table",""],[1,"h-fit","border-[1px]","shadow-xl","mt-4","bg-white","rounded-lg","p-5"],[1,"flex","flex-col","items-start","lg:flex-row","sm:items-center","justify-between"],[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","gap-3","w-1/3","max-lg:w-full"],["for","table-search",1,"sr-only"],[1,"relative","my-2","w-full"],[1,"absolute","inset-y-0","rtl:inset-r-0","start-0","flex","items-center","ps-3","pointer-events-none"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 20 20",1,"w-4","h-4","text-gray-500","dark:text-gray-400"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"],["type","text","matInput","","placeholder","Search Tickets",1,"block","w-full","p-4","ps-10","text-sm","text-gray-900","border","border-gray-300","rounded-lg","bg-gray-50","focus:ring-blue-500","focus:border-blue-500","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500",3,"keyup"],[1,"flex","items-center","gap-3"],["mat-raised-button","",1,"flex","w-fit","text-nowrap","items-center","gap-2","p-2.5","rounded-full","px-3","sm:px-5","text-white",3,"disabled","matMenuTriggerFor","ngClass"],[1,"flex","items-center","gap-1"],[1,"m-2","pr-4","border-r-[1px]"],["svgIcon","keyboard_arrow_down",1,"font-bold","text-2xl"],["mat-menu-item","",3,"routerLink"],["svgIcon","mat_outline:add",1,"icon-size-5"],["mat-menu-item","",3,"click"],["svgIcon","mat_outline:upload_file",1,"icon-size-5"],["mat-raised-button","",1,"flex","w-fit","text-nowrap","items-center","gap-2","p-2.5","rounded-full","px-3","sm:px-5","bg-red-500","text-white",3,"click"],["svgIcon","mat_solid:picture_as_pdf",1,"text-white"],[1,"max-sm:hidden","font-semibold"],[1,"min-w-[300px]","max-w-full","self-end","hidden","sm:block"],[1,"w-full",3,"rangePicker","formGroup"],["matStartDate","","formControlName","start","placeholder","Start date",1,"w-full"],["matEndDate","","formControlName","end","placeholder","End date",1,"w-full"],["matSuffix","",3,"for"],["touchUi",""],[1,"flex","items-center","gap-2","p-2.5","rounded-full","px-3","sm:px-5","border-[1px]","text-white",3,"matMenuTriggerFor"],["svgIcon","filter_alt"],[1,"max-sm:hidden","font-semibold","text-black"],["svgIcon","keyboard_arrow_down"],["mat-menu-item","",3,"matMenuTriggerFor","matMenuTriggerData"],[1,"min-w-[300px]"],[1,"px-5","py-3","w-full"],[1,"font-semibold","mb-2"],[1,"px-5","flex","flex-col","gap-2","w-full"],["class","h-full",3,"ngModel","ngModelChange","click","change",4,"ngFor","ngForOf"],["class","h-full w-full",3,"ngModel","ngModelChange","click","change",4,"ngFor","ngForOf"],[1,"px-5","py-3"],[1,"min-w-[300px]","max-w-full","pt-4","self-start","sm:hidden","block"],["role","status","class","p-5 animate-pulse",4,"ngIf"],[1,"w-full","overflow-auto","whitespace-nowrap","mt-5"],["matSort","","class","min-w-[2480px]",3,"dataSource",4,"ngIf"],["class","py-10",4,"ngIf"],[3,"pageSize","pageSizeOptions","showFirstLastButtons"],[1,"h-full",3,"ngModelChange","click","change","ngModel"],[1,"h-full","w-full",3,"ngModelChange","click","change","ngModel"],[1,"px-3","py-1","text-white","whitespace-nowrap","rounded-full",3,"ngClass"],[1,"font-medium"],["svgIcon","mat_outline:bookmark",1,"-rotate-90",3,"ngClass"],[1,"font-medium","uppercase"],["role","status",1,"p-5","animate-pulse"],[1,"h-6","bg-gray-300","rounded-full","dark:bg-gray-700","w-full","mb-[22px]"],[1,"h-6","bg-gray-300","rounded-full","dark:bg-gray-700","w-full"],["matSort","",1,"min-w-[2480px]",3,"dataSource"],["matColumnDef","tracking_id"],[4,"matHeaderCellDef"],["class","text-lg text-blue-600 font-medium underline whitespace-nowrap",4,"matCellDef"],["matColumnDef","hari_masuk"],["class","flex items-center gap-3",4,"matCellDef"],["matColumnDef","waktu_masuk"],["matColumnDef","category"],["class","flex items-center gap-3 font-medium",4,"matCellDef"],["matColumnDef","name"],["class","py-3.5 flex items-center gap-3 w-fit",4,"matCellDef"],["matColumnDef","pic"],[4,"matCellDef"],["matColumnDef","subject"],["class","font-bold text-lg",4,"matCellDef"],["matColumnDef","no_whatsapp"],["matColumnDef","status"],["class","py-4 w-full",4,"matCellDef"],["matColumnDef","solved_time"],["matColumnDef","last_replier"],["class","py-2 flex items-center gap-3 w-fit",4,"matCellDef"],["matColumnDef","priority"],["matColumnDef","create_date"],["matColumnDef","create_time"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"text-lg","text-blue-600","font-medium","underline","whitespace-nowrap"],[3,"routerLink"],["svgIcon","mat_solid:date_range"],["svgIcon","mat_outline:access_time"],[1,"flex","items-center","gap-3","font-medium"],[1,"py-3.5","flex","items-center","gap-3","w-fit"],[1,"w-full","flex","items-center","gap-3"],["alt","",1,"w-7","h-7","object-cover","rounded-full",3,"src"],[1,"font-bold","text-lg"],["target","_blank",3,"href"],[1,"py-4","w-full"],["hideRequiredMarker","",1,"w-full"],["placeholder","Select",3,"valueChange","value","disabled"],["class","px-3 py-1 m-2 font-medium text-base rounded-full",3,"value","click",4,"ngFor","ngForOf"],[1,"px-3","py-1","m-2","font-medium","text-base","rounded-full",3,"click","value"],[1,"py-2","flex","items-center","gap-3","w-fit"],["alt","",1,"w-7","h-7","rounded-full",3,"src"],[1,"py-10"],[1,"flex","flex-col","items-center"],["src","icons/not-found.jpg","alt","not-found.jpg",1,"h-64","bg-cover","bg-center","object-scale-down"],[1,"text-lg","font-semibold"],[1,"text-sm"]],template:function(i,n){if(1&i){const l=e.RV6();e.j41(0,"section",9)(1,"div",10)(2,"div",11)(3,"label",12),e.EFF(4,"Search"),e.k0s(),e.j41(5,"div",13)(6,"div",14),e.qSk(),e.j41(7,"svg",15),e.nrm(8,"path",16),e.k0s()(),e.joV(),e.j41(9,"input",17),e.bIt("keyup",function(p){return e.eBV(l),e.Njj(n.applySearchFilter(p.target.value))}),e.k0s()()(),e.j41(10,"div",18)(11,"button",19)(12,"div",20)(13,"span",21),e.EFF(14,"New Tickets"),e.k0s(),e.nrm(15,"mat-icon",22),e.k0s()(),e.j41(16,"mat-menu",null,0)(18,"button",23),e.nrm(19,"mat-icon",24),e.j41(20,"span"),e.EFF(21,"Add Tickets"),e.k0s()(),e.j41(22,"button",25),e.bIt("click",function(){return e.eBV(l),e.Njj(n.importExcel())}),e.nrm(23,"mat-icon",26),e.j41(24,"span"),e.EFF(25,"Import Excel"),e.k0s()()(),e.j41(26,"button",27),e.bIt("click",function(){return e.eBV(l),e.Njj(n.generateReport())}),e.nrm(27,"mat-icon",28),e.j41(28,"span",29),e.EFF(29,"Generate Report"),e.k0s()(),e.j41(30,"mat-form-field",30)(31,"mat-date-range-input",31),e.nrm(32,"input",32)(33,"input",33),e.k0s(),e.nrm(34,"mat-datepicker-toggle",34)(35,"mat-date-range-picker",35,1),e.k0s(),e.j41(37,"button",36),e.nrm(38,"mat-icon",37),e.j41(39,"span",38),e.EFF(40,"Filter"),e.k0s(),e.nrm(41,"mat-icon",39),e.k0s(),e.j41(42,"mat-menu",null,2)(44,"button",40),e.EFF(45,"Products"),e.k0s(),e.j41(46,"button",40),e.EFF(47,"Category"),e.k0s(),e.j41(48,"button",40),e.EFF(49,"Status"),e.k0s(),e.j41(50,"button",40),e.EFF(51,"Priority"),e.k0s(),e.j41(52,"mat-menu",41,3)(54,"div",42)(55,"h1",43),e.EFF(56,"Choose Products"),e.k0s()(),e.j41(57,"div",44),e.DNE(58,q,2,2,"mat-checkbox",45),e.k0s()(),e.j41(59,"mat-menu",41,4)(61,"div",42)(62,"h1",43),e.EFF(63,"Choose Category"),e.k0s()(),e.j41(64,"div",44),e.DNE(65,ee,2,2,"mat-checkbox",46),e.k0s()(),e.j41(66,"mat-menu",null,5)(68,"div",47)(69,"h1",43),e.EFF(70,"Choose status"),e.k0s()(),e.DNE(71,te,4,7,"mat-checkbox",45),e.k0s(),e.j41(72,"mat-menu",null,6)(74,"div",47)(75,"h1",43),e.EFF(76,"Choose Priority"),e.k0s()(),e.DNE(77,ae,5,8,"mat-checkbox",45),e.k0s()()(),e.j41(78,"mat-form-field",48)(79,"mat-date-range-input",31),e.nrm(80,"input",32)(81,"input",33),e.k0s(),e.nrm(82,"mat-datepicker-toggle",34)(83,"mat-date-range-picker",null,1),e.k0s()(),e.DNE(85,ne,8,0,"div",49),e.j41(86,"div",50),e.DNE(87,Ve,49,5,"mat-table",51),e.k0s(),e.DNE(88,Ge,8,0,"div",52),e.nrm(89,"mat-paginator",53,7),e.k0s()}if(2&i){const l=e.sdS(17),m=e.sdS(36),p=e.sdS(43),g=e.sdS(53),k=e.sdS(60),u=e.sdS(67),j=e.sdS(73);e.R7$(11),e.Y8G("disabled",n.shiftStatus&&!n.isAdmin)("matMenuTriggerFor",l)("ngClass",n.shiftStatus&&!n.isAdmin?"bg-gray-400":"bg-primary"),e.R7$(7),e.Y8G("routerLink",e.lJ4(29,K)),e.R7$(13),e.Y8G("rangePicker",m)("formGroup",n.range),e.R7$(3),e.Y8G("for",m),e.R7$(3),e.Y8G("matMenuTriggerFor",p),e.R7$(7),e.Y8G("matMenuTriggerFor",g)("matMenuTriggerData",e.lJ4(30,R)),e.R7$(2),e.Y8G("matMenuTriggerFor",k)("matMenuTriggerData",e.lJ4(31,R)),e.R7$(2),e.Y8G("matMenuTriggerFor",u)("matMenuTriggerData",e.lJ4(32,R)),e.R7$(2),e.Y8G("matMenuTriggerFor",j)("matMenuTriggerData",e.lJ4(33,R)),e.R7$(8),e.Y8G("ngForOf",n.productsItems),e.R7$(7),e.Y8G("ngForOf",n.category),e.R7$(6),e.Y8G("ngForOf",n.statusItems),e.R7$(6),e.Y8G("ngForOf",n.priorityItems),e.R7$(2),e.Y8G("rangePicker",m)("formGroup",n.range),e.R7$(3),e.Y8G("for",m),e.R7$(3),e.Y8G("ngIf",n.isLoading),e.R7$(2),e.Y8G("ngIf",!n.isLoading),e.R7$(),e.Y8G("ngIf",n.isNotFound&&!n.isLoading),e.R7$(),e.Y8G("pageSize",10)("pageSizeOptions",e.lJ4(34,z))("showFirstLastButtons",!0)}},dependencies:[F.MD,F.YU,F.Sq,F.bT,I.Ou,I.iy,D.hM,h.tP,h.Zl,h.tL,h.ji,h.cC,h.YV,h.iL,h.KS,h.$R,h.YZ,h.NB,d.X1,d.me,d.BC,d.cb,d.j4,d.JD,b.fS,b.fg,c.rl,c.yw,$.NQ,$.B4,_.An,E.Cn,E.kk,E.fb,E.Cp,S.g7,S.So,d.YN,d.vS,c.RG,f.X6,f.bU,f.el,f.xR,f.IG,f.SG,M.Ve,M.VO,C.wT,C.Sy,L.Hl,L.$z,y.Wk],styles:[".mat-mdc-form-field-subscript-wrapper{display:none!important}",".mat-mdc-form-field-subscript-wrapper[_ngcontent-%COMP%] {\n        display: none;\n    }"]})}}return a})();const Ye=()=>["/dashboards/home"];let Oe=(()=>{class a{static{this.\u0275fac=function(i){return new(i||a)}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-tickets"]],standalone:!0,features:[e.aNF],decls:17,vars:2,consts:[[1,"p-4","h-full","w-full","sm:px-5"],[1,"px-1","pt-3","flex","justify-between","items-start","sm:items-center","flex-col","sm:flex-row","gap-5","sm:gap-0"],[1,"font-bold","text-lg","sm:text-3xl"],[1,"text-sm","sm:text-base"],[1,"text-sm","text-gray-600"],[1,"font-medium","text-gray-500","hover:cursor-pointer","hover:text-blue-400",3,"routerLink"],[1,"mx-2","text-gray-400"],[1,"font-semibold","text-blue-600","hover:text-blue-500"],[1,"h-fit","w-full"]],template:function(i,n){1&i&&(e.j41(0,"main",0)(1,"div",1)(2,"div")(3,"h1",2),e.EFF(4,"Tickets"),e.k0s(),e.j41(5,"p",3),e.EFF(6,"Keep track of ongoing tickets and follow up efficiently."),e.k0s()(),e.j41(7,"div",4)(8,"span",5),e.EFF(9,"Home"),e.k0s(),e.j41(10,"span",6),e.EFF(11,"/"),e.k0s(),e.j41(12,"span",7),e.EFF(13,"Tickets"),e.k0s()()(),e.j41(14,"div",8),e.nrm(15,"app-ticket")(16,"app-ticket-logs"),e.k0s()()),2&i&&(e.R7$(8),e.Y8G("routerLink",e.lJ4(1,Ye)))},dependencies:[Ae,x.V,y.Wk],encapsulation:2,changeDetection:0})}}return a})();var Ue=s(25798),Xe=s(96697),We=s(96354);const Je=[{path:"",component:Oe},{path:"add-tickets",canActivate:[(a,o)=>{const t=(0,e.WQX)(y.Ix),i=(0,e.WQX)(Ue.D),n="admin"===localStorage.getItem("userRole");return i.user$.pipe((0,Xe.s)(1),(0,We.T)(l=>!(!n&&"Active Shift"!==l.shift_status)||t.parseUrl("/dashboards/tickets")))}],loadChildren:()=>Promise.all([s.e(6233),s.e(2076),s.e(789)]).then(s.bind(s,10789))},{path:":trackingId",loadChildren:()=>Promise.all([s.e(6233),s.e(1526)]).then(s.bind(s,21526))}]},35883:(Y,w,s)=>{s.d(w,{M:()=>C});var y=s(10467),x=s(54438),T=s(84412),F=s(86648),e=s(88141),d=s(3366),S=s(45794);let C=(()=>{class f{constructor(c,_){this._apiService=c,this._toastService=_,this._data=new T.t(null),this._datas=(0,x.vPA)([]),this.isLoading=(0,x.vPA)(!0),this.isNotFound=(0,x.vPA)(!1)}get data$(){return this._data.asObservable()}Update(c){this._data.next(c)}checkTickets(){return(0,F.H)(this._apiService.get("api/V1/check-tickets-deadline")).pipe((0,e.M)(c=>{console.log(c)}))}fetchDataByDate(c,_){this.isLoading.set(!0),this._apiService.get(`api/V1/tickets-date?start_date=${c}&end_date=${_}`).then(b=>{this.isLoading.set(!1),this.isNotFound.set(!1),this._datas.set(b.data),null!==b.data&&0!=b.data.length||this.isNotFound.set(!0)}).catch(b=>{this.isLoading.set(!1),this.isNotFound.set(!0),this._toastService.error("Failed to fetch data","Error")})}fetchData(){var c=this;return(0,y.A)(function*(){c.isLoading.set(!0),c._apiService.get("api/V1/tickets").then(_=>{c.isLoading.set(!1),c.isNotFound.set(!1),c._datas.set(_.data),null!==_.data&&0!=_.data.length||c.isNotFound.set(!0)}).catch(_=>{c.isLoading.set(!1),c.isNotFound.set(!0),c._toastService.error("Failed to fetch data","Error")})})()}static{this.\u0275fac=function(_){return new(_||f)(x.KVO(d.G),x.KVO(S.tw))}}static{this.\u0275prov=x.jDH({token:f,factory:f.\u0275fac,providedIn:"root"})}}return f})()}}]);