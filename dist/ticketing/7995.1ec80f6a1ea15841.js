"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[7995],{67995:(E,d,a)=>{a.r(d),a.d(d,{default:()=>T});var g=a(10467),c=a(60177),r=a(89417),t=a(54438);const v=["inputEl"];function y(o,l){if(1&o){const e=t.RV6();t.j41(0,"input",2,0),t.bIt("focus",function(i){t.eBV(e);const s=t.XpG();return t.Njj(s.handleFocus(i))})("blur",function(){t.eBV(e);const i=t.XpG();return t.Njj(null==i.onTouched?null:i.onTouched())})("keypress",function(i){const s=t.eBV(e).index,u=t.XpG();return t.Njj(u.handleKeyPress(i,s))})("input",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.handleInput())})("keydown",function(i){const s=t.eBV(e).index,u=t.XpG();return t.Njj(u.handleKeyDown(i,s))})("paste",function(i){const s=t.eBV(e).index,u=t.XpG();return t.Njj(u.handlePaste(i,s))}),t.k0s()}if(2&o){const n=l.index;t.Y8G("formControl",l.$implicit),t.BMQ("autocomplete",0===n?"one-time-code":null)}}function h(o){const l=[];for(let e=0;e<o;e++)l.push(new r.MJ(""));return new r.Yp(l)}let x=(()=>{class o{constructor(){this.#t=6,this.#e=null,this.inputs=h(this.#t)}set size(e){this.inputs=h(e),this.#t=e}#t;#e;writeValue(e){if((0,t.naY)()&&e?.length)throw new Error("Otp input is not supposed to be prefilled with data");this.inputs.setValue(new Array(this.#t).fill(""))}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){e?this.inputs.disable():this.inputs.enable()}validate(e){return!e.value||e.value.length<this.#t?{otpInput:"Value is incorrect"}:null}handleKeyDown(e,n){("Backspace"===e.key||"Delete"===e.key)&&n>0&&(this.#e=n-1)}handleInput(){this.#i(),null!=this.#e&&(this.#n(this.#e),this.#e=null)}handleKeyPress(e,n){const i=/\d/.test(e.key);return!("v"!==e.key||!e.metaKey)||(i&&n+1<this.#t&&(this.#e=n+1),i&&this.inputs.controls[n].value&&this.inputs.controls[n].setValue(""),i)}handlePaste(e,n){if(e.preventDefault(),0!==n)return;const i=e.clipboardData?.getData("text"),s=new RegExp(`\\d{${this.#t}}`);if(i&&s.test(i)){for(let u=0;u<i.length;u++)this.inputs.controls[u].setValue(i[u]);this.#n(this.inputEls.length-1),this.#i(),this.onTouched()}}handleFocus(e){e.target.select()}#n(e){setTimeout(()=>this.inputEls.get(e)?.nativeElement.focus())}#i(){setTimeout(()=>this.onChange?.(this.inputs.value.join("")))}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-otp-input"]],viewQuery:function(n,i){if(1&n&&t.GBs(v,5),2&n){let s;t.mGM(s=t.lsd())&&(i.inputEls=s)}},inputs:{size:"size"},standalone:!0,features:[t.Jv_([{provide:r.kq,useExisting:o,multi:!0},{provide:r.cz,useExisting:o,multi:!0}]),t.aNF],decls:1,vars:1,consts:[["inputEl",""],["type","text","inputmode","numeric",3,"formControl","focus","blur","keypress","input","keydown","paste",4,"ngFor","ngForOf"],["type","text","inputmode","numeric",3,"focus","blur","keypress","input","keydown","paste","formControl"]],template:function(n,i){1&n&&t.DNE(0,y,2,2,"input",1),2&n&&t.Y8G("ngForOf",i.inputs.controls)},dependencies:[r.X1,r.me,r.BC,r.l_,c.MD,c.Sq],styles:["[_nghost-%COMP%]{display:flex;gap:.3em;font-size:24px}input[_ngcontent-%COMP%]{aspect-ratio:3/4;width:2em;text-align:center;border-radius:4px;font-size:inherit;border:.1em solid #aaa}input[_ngcontent-%COMP%]:focus{outline:0;border-color:#87ceeb;box-shadow:0 0 0 .1em #87ceeb}input[_ngcontent-%COMP%]:disabled{border-color:#eee}"],changeDetection:0})}}return o})();var m=a(2490),_=a(3366),b=a(45794),C=a(35524),f=a(74710),O=a(21626),j=a(25798);const w=()=>({standalone:!0}),T=[{path:"",component:(()=>{class o{constructor(e,n,i,s,u,p,F,V,I){this.cookieService=e,this.apiService=n,this.toast=i,this.auth=s,this._activatedRoute=u,this._router=p,this._httpClient=F,this._cookies=V,this._userService=I,this.className="w-full",this.data=""}ngOnInit(){this.email=this.cookieService.get("otp-email")}onSubmit(){var e=this;return(0,g.A)(function*(){try{const{data:n,status:i}=yield e.apiService.post("api/V1/verify-otp",{email:e.email,otp:e.data});if(401===i)return void e.toast.error("The OTP you entered is incorrect. Please try again.","Invalid OTP");if(500===i)return void e.toast.error("Internal Server Error.","Internal Error");200===i&&(localStorage.setItem("userRole",n.user.role),localStorage.setItem("accessToken",n.user.token),e._userService.Update(n.user),e._cookies.deleteAll("/"));const s=e._activatedRoute.snapshot.queryParamMap.get("redirectURL")||"/signed-in-redirect";e._router.navigateByUrl(s)}catch(n){throw n}})()}static{this.\u0275fac=function(n){return new(n||o)(t.rXU(m.O),t.rXU(_.G),t.rXU(b.tw),t.rXU(C.u),t.rXU(f.nX),t.rXU(f.Ix),t.rXU(O.Qq),t.rXU(m.O),t.rXU(j.D))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-otp"]],hostVars:2,hostBindings:function(n,i){2&n&&t.HbH(i.className)},standalone:!0,features:[t.aNF],decls:20,vars:4,consts:[["input","ngModel"],[1,"w-full","h-full","flex","justify-center","items-center","bg-[url('/assets/images/cards/moon.jpg')]","bg-center","bg-cover","max-sm:px-22"],[1,"max-w-md","mx-auto","text-center","bg-white","px-4","sm:px-8","py-10","rounded-xl","shadow-xl"],[1,"mb-8"],[1,"text-2xl","font-bold","mb-1"],[1,"text-[15px]","text-slate-500"],[1,"text-blue-500","font-semibold"],["id","otp-form",3,"ngSubmit"],[1,"flex","items-center","justify-center","gap-3"],[3,"ngModelChange","ngModel","ngModelOptions"],[1,"max-w-[320px]","mx-auto","mt-4"],["type","submit",1,"w-full","inline-flex","justify-center","whitespace-nowrap","rounded-lg","bg-indigo-500","px-3.5","py-2.5","text-sm","font-medium","text-white","shadow-sm","shadow-indigo-950/10","hover:bg-indigo-600","focus:outline-none","focus:ring","focus:ring-indigo-300","focus-visible:outline-none","focus-visible:ring","focus-visible:ring-indigo-300","transition-colors","duration-150"],[1,"text-sm","text-slate-500","mt-4"],["href","#0",1,"font-medium","text-indigo-500","hover:text-indigo-600"]],template:function(n,i){if(1&n){const s=t.RV6();t.j41(0,"section",1)(1,"div",2)(2,"header",3)(3,"h1",4),t.EFF(4,"Mobile Phone Verification"),t.k0s(),t.j41(5,"p",5),t.EFF(6,"Enter the 4-digit verification code that was sent to "),t.j41(7,"span",6),t.EFF(8),t.k0s()()(),t.j41(9,"form",7),t.bIt("ngSubmit",function(){return t.eBV(s),t.Njj(i.onSubmit())}),t.j41(10,"div",8)(11,"app-otp-input",9,0),t.mxI("ngModelChange",function(p){return t.eBV(s),t.DH7(i.data,p)||(i.data=p),t.Njj(p)}),t.k0s()(),t.j41(13,"div",10)(14,"button",11),t.EFF(15," Verify Account "),t.k0s()()(),t.j41(16,"div",12),t.EFF(17,"Didn't receive code? "),t.j41(18,"a",13),t.EFF(19,"Resend"),t.k0s()()()()}2&n&&(t.R7$(8),t.JRh(i.email),t.R7$(3),t.R50("ngModel",i.data),t.Y8G("ngModelOptions",t.lJ4(3,w)))},dependencies:[r.YN,r.qT,r.BC,r.cb,r.vS,r.cV,c.MD,x],styles:[".otp-container[_ngcontent-%COMP%]{width:100%}"]})}}return o})()}]}}]);